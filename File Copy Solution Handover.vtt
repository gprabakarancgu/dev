WEBVTT

b33533fe-11cb-4865-9111-c2bb4a3300a9-0
00:00:02.920 --> 00:00:16.960
Yeah, OK.

f5060b59-8369-4a4c-872f-bbfb5573a45c-0
00:00:19.160 --> 00:00:29.042
So the main issue did the reason that we
started looking at copying file using

f5060b59-8369-4a4c-872f-bbfb5573a45c-1
00:00:29.042 --> 00:00:38.800
function app is because when we do that
using Logic app, it's leaking memory.

6a814b5a-e68c-4536-be90-ccab5cd7201c-0
00:00:39.760 --> 00:00:46.658
So the way that the Logic app rates is it
read the full content of the file to the

6a814b5a-e68c-4536-be90-ccab5cd7201c-1
00:00:46.658 --> 00:00:47.240
memory.

46c15aeb-f7f7-4657-920c-9fe6990d41e4-0
00:00:48.120 --> 00:00:54.089
And then I think there was a maybe let me
there's a good example of what's actually

46c15aeb-f7f7-4657-920c-9fe6990d41e4-1
00:00:54.089 --> 00:00:54.800
happening.

389c9d69-89df-4400-bf76-1fb6d809167b-0
00:00:55.200 --> 00:01:09.440
Let me try try to OK,
let me try to open the logic app.

942db9c5-ea1a-475b-aa7d-9ab7a80cb4c1-0
00:01:14.720 --> 00:01:21.619
So logic app on my normal browser,
I can't go to the run history and see all

942db9c5-ea1a-475b-aa7d-9ab7a80cb4c1-1
00:01:21.619 --> 00:01:23.680
the inputs and outputs.

64910ea0-eadf-4959-9c77-8ba4d63eca95-0
00:01:26.080 --> 00:01:28.840
Yeah, yeah_your account.

b49b3486-031a-4c83-8fee-8752dafd483d-0
00:01:28.840 --> 00:01:33.680
You open it from this path,
this security thing.

f69dd4f5-68e0-4f25-8870-839b6a70db1c-0
00:01:34.240 --> 00:01:37.120
Yeah, you should like me.

97a580fd-6630-437f-9f99-178a89e7e9db-0
00:02:15.680 --> 00:02:22.978
In in Azure it sort of gives a breakdown
of what's actually happening in Logic

97a580fd-6630-437f-9f99-178a89e7e9db-1
00:02:22.978 --> 00:02:23.440
Apps.

f5085a23-be0d-45e3-b6a9-d83cca068d78-0
00:02:24.320 --> 00:02:28.320
So switch back to the network.

88c46bfa-7bdf-4a62-8d77-ab37eadcd526-0
00:02:49.520 --> 00:03:11.520
Let's go to production,
have a look production.

101ad7ee-b61e-4c9e-be1d-9c56cbd98e91-0
00:03:13.640 --> 00:03:19.865
So if you're ever having any issues with
any Azure service,

101ad7ee-b61e-4c9e-be1d-9c56cbd98e91-1
00:03:19.865 --> 00:03:27.440
the 1st place probably to get started is
go to diagnostics and problems.

a0f77f12-1570-4631-bb02-1cd93918a897-0
00:03:29.320 --> 00:03:35.920
So diagnostics, I think it was under here.

3146382c-9072-4676-8c5a-187158f8aa93-0
00:03:54.360 --> 00:03:55.520
Where did it go?

7f049a09-cf10-4e2f-8361-f681d1ce356b-0
00:04:02.070 --> 00:04:03.910
It just got disconnected, I guess.

287f92fe-17ef-444d-9d7a-f84d36636c68-0
00:04:06.230 --> 00:04:10.510
Anyway, probably I'll, I'll,
I'll get to that later.

a0c45a22-9705-46be-ab58-a30b19ff0386-0
00:04:10.750 --> 00:04:17.502
But So what I was trying to to tell is
that so the issue with the the logic app

a0c45a22-9705-46be-ab58-a30b19ff0386-1
00:04:17.502 --> 00:04:24.085
is logic app doesn't allow to read the
file from BLOB storage like it doesn't

a0c45a22-9705-46be-ab58-a30b19ff0386-2
00:04:24.085 --> 00:04:25.520
allow the stream.

4a93f7e6-ce62-47d0-99c1-a9e5937d5415-0
00:04:25.960 --> 00:04:31.600
So it reads a whole file into the memory
and then keeps it in the memory and then

4a93f7e6-ce62-47d0-99c1-a9e5937d5415-1
00:04:31.600 --> 00:04:35.040
try to write the whole file into into
SharePoint.

40824527-1de3-4acf-83ce-d24fd38cf61d-0
00:04:35.600 --> 00:04:43.840
So what happens is so when you run the
trigger, it reads.

3f12079b-e316-4a4c-94aa-0dd8a7676de5-0
00:04:44.040 --> 00:04:46.880
So the logic app runs in a loop, right?

f705ec50-a719-4617-837e-e5163cab1666-0
00:04:46.880 --> 00:04:52.106
So it looks at the notes and look at the
list of files,

f705ec50-a719-4617-837e-e5163cab1666-1
00:04:52.106 --> 00:04:56.960
and so it reads the whole set of files
into memory.

b3bbe0d2-3fde-4c95-9a14-603d7d0db4ce-0
00:04:57.360 --> 00:05:02.640
So even though you're looping and writing,
it doesn't.

ed953459-8bf0-401c-9467-1b100ffee961-0
00:05:02.680 --> 00:05:04.840
That memory does not get disposed.

8307d57d-4ee9-4265-be3b-dc648845373b-0
00:05:04.840 --> 00:05:11.593
So you write 1 by file, 1 by 1,
but each file get loaded into the memory

8307d57d-4ee9-4265-be3b-dc648845373b-1
00:05:11.593 --> 00:05:18.440
and get written and remains in the memory
until the trigger get finished.

3c572db1-ae2a-431b-b6da-ad4874f3c31d-0
00:05:19.040 --> 00:05:26.477
So at a given point, if you for example,
in that performance test,

3c572db1-ae2a-431b-b6da-ad4874f3c31d-1
00:05:26.477 --> 00:05:34.360
if you were testing 15 files,
1550 megabyte files, so what's that 2.2?

cfe94190-ddc9-4c51-a3d8-f08843052a45-0
00:05:37.280 --> 00:05:39.280
That's 200 megabytes right to 1.

2de38cbe-2bf2-4eb2-a3bc-535920bff03c-0
00:05:39.400 --> 00:05:41.000
So whatever that number is.

b7fcb590-442a-4b97-84e5-2f3628eb86c4-0
00:05:42.280 --> 00:05:48.080
So that amount of memory get blocked in
the Logic app while it's been copied.

62425129-b470-48dd-bc96-765f7876bf0d-0
00:05:49.120 --> 00:05:54.120
So if you have parallel so then the Logic
app will be competing for memory.

2d1abd49-ca56-459b-91d0-259ba3623c7f-0
00:05:54.840 --> 00:05:57.240
So what happens in in that case?

37b2a712-a06b-40a1-9ec4-6b21278efbbe-0
00:05:57.760 --> 00:06:02.440
So Logic App is ultimately a function app
in the background.

f0050c24-5bb2-4ff1-8a0b-507aae923ce9-0
00:06:02.560 --> 00:06:07.160
So that that's that's the core technology
that it uses.

3d8221dc-0d9e-4be8-a472-34167695f69d-0
00:06:09.120 --> 00:06:15.922
So what happens is then the underlyings,
the function app service loses memory and

3d8221dc-0d9e-4be8-a472-34167695f69d-1
00:06:15.922 --> 00:06:17.480
it starts crashing.

eb6fead9-e365-4969-bc87-5313b5cc6773-0
00:06:17.880 --> 00:06:25.323
So when it starts crashing so Logic app
is like I think the Logic app that we run

eb6fead9-e365-4969-bc87-5313b5cc6773-1
00:06:25.323 --> 00:06:33.040
is a stateful logic app so it knows where
it's last successfully ran and it retries.

8c55774d-3dfc-44e3-aaa1-4ec682603e1d-0
00:06:33.240 --> 00:06:38.920
So eventually the file get copied but it
runs through many restarts.

1f977641-fe6b-4f74-b191-d0797f907ce7-0
00:06:40.720 --> 00:06:51.800
So so to get around that issue so we POC
copying file using functional.

53f9d1fd-b705-4a66-a816-98a13e997709-0
00:06:53.320 --> 00:06:56.091
So,
so every environment even production have

53f9d1fd-b705-4a66-a816-98a13e997709-1
00:06:56.091 --> 00:06:58.200
this function app deployed already.

4112d633-2cd2-4b28-9fbd-c443ac764361-0
00:06:59.280 --> 00:07:00.840
The function app is already there.

6f57efff-bbb8-4216-823f-ae67839b90f0-0
00:07:02.400 --> 00:07:09.400
So I've written a.
net core function app to copy file.

27b02779-1e36-4908-be78-98459835399f-0
00:07:11.080 --> 00:07:16.920
So this is this function app is a queue
trigger.

b1126d31-0dcb-410d-bc8c-9410bc690b5f-0
00:07:19.240 --> 00:07:24.640
So the reason there's a queue in between
the function app and the logic app.

7909888c-b213-4f3c-8267-00099d77bbbc-0
00:07:24.960 --> 00:07:32.320
So the way what we're proposing it would
work is Logic app still will will exist.

5a3b9b39-260f-4998-aa48-249f9e736cf2-0
00:07:33.680 --> 00:07:39.520
So Logic app will have all the the QY
related business logic, right?

b9200dea-22e7-42c0-ade3-201a51f7a24f-0
00:07:39.520 --> 00:07:44.477
So, so QY related business logic,
if you go to the current Logic app,

b9200dea-22e7-42c0-ade3-201a51f7a24f-1
00:07:44.477 --> 00:07:47.240
there's a lot of business logic, right?

a18faa1a-f26e-458d-840d-3a3be7d4214b-0
00:07:47.240 --> 00:07:52.000
Reading the metadata and reading the
notes and all that.

27b57acd-0544-4a2d-9bd0-e0eb458e5e88-0
00:07:52.280 --> 00:07:54.680
We're not going to move any of that into
the functional.

83a74c15-7163-4041-9057-ed6ba8a1a8ba-0
00:07:55.040 --> 00:07:58.720
So that all remains in the Logic app.

ec6b8535-4e6b-4091-8c4c-e1107a5408a5-0
00:07:59.600 --> 00:08:05.929
So Logic App figures out the business and
the properties and how many files to copy

ec6b8535-4e6b-4091-8c4c-e1107a5408a5-1
00:08:05.929 --> 00:08:10.074
and what to copy and when it's ready to
copy the file,

ec6b8535-4e6b-4091-8c4c-e1107a5408a5-2
00:08:10.074 --> 00:08:14.520
where in the Logic app where it reads
content of the file.

ee5a4dc9-c096-44de-8a7b-dc0c8861803b-0
00:08:14.920 --> 00:08:19.824
So instead of reading the content of the
file,

ee5a4dc9-c096-44de-8a7b-dc0c8861803b-1
00:08:19.824 --> 00:08:24.520
pass a publish a queue message to the
queue.

e3085d1e-313e-43e3-ada0-5e9d01553754-0
00:08:24.840 --> 00:08:29.360
So the reason a queue is used for load
levelling, right?

c0a86745-ed78-4e94-845e-7f68afabc537-0
00:08:29.360 --> 00:08:30.640
So load levelling is.

e257f483-8625-4c61-9ee9-cb2e5e04d185-0
00:08:31.360 --> 00:08:34.680
So at the moment production setting is.

eaf4c92a-9c55-4dff-9909-6af93728aa9e-0
00:08:35.960 --> 00:08:44.400
So we have that concurrency queue queuing
enabled for the trigger.

a4f59506-ca6b-4101-9364-5934b01689f4-0
00:08:45.080 --> 00:08:47.000
So I think we probably have it here.

e520a08d-beb2-492a-a84a-ef12e74d70d1-0
00:08:47.840 --> 00:08:56.200
We go to the workflows and this one here,
right?

b6185589-664d-4d66-94d4-46706a54ae7b-0
00:08:56.200 --> 00:09:04.360
So what?

80d3aadc-8bf1-4abb-8aa8-2f7a6730d108-0
00:09:12.070 --> 00:09:13.710
So what happens here is.

c547e3a8-eb48-4c58-8b36-beec40d71870-0
00:09:15.230 --> 00:09:16.190
So I think we've got.

595c1037-de87-46df-ae3f-848665bd572f-0
00:09:16.190 --> 00:09:19.350
I don't know why it's not loading up.

bc8575e7-9ae9-4d6d-8aed-f3f6a022d7f2-0
00:09:26.880 --> 00:09:31.899
Let it would, yeah, Yeah,
I think we've said some concurrency

bc8575e7-9ae9-4d6d-8aed-f3f6a022d7f2-1
00:09:31.899 --> 00:09:33.600
settings here, right?

1cf6ecd9-42c3-49d2-846f-ee1a7a6991f8-0
00:09:37.200 --> 00:09:37.360
Yeah.

9e4f7cb2-faef-40cc-9888-a399b614b3c4-0
00:09:37.360 --> 00:09:43.514
So we have 5 concurrency,
5 triggers to be run parallel and if

9e4f7cb2-faef-40cc-9888-a399b614b3c4-1
00:09:43.514 --> 00:09:46.640
there's more than it get queued.

feeb7b59-4cad-4fad-bfce-0ccf43f62b4a-0
00:09:47.320 --> 00:09:50.960
But I think the the the reason the queue
is being used.

eedf7a94-344a-44b9-a336-2b4323c9d7f8-0
00:09:52.280 --> 00:09:56.000
So Logic app only can queue 100 items,
right?

cdfbf096-58d7-476d-ac10-165c7edbb941-0
00:09:56.080 --> 00:10:01.051
But if we use this sort of solution in a
more high throughput environment,

cdfbf096-58d7-476d-ac10-165c7edbb941-1
00:10:01.051 --> 00:10:05.360
100 is not enough and then five is
definitely not enough, right?

06662d6d-71ca-40b1-9add-d7fe1745aea4-0
00:10:05.360 --> 00:10:07.840
So, so the queue will.

edfe6f52-42fa-40f2-8a24-0b4d326845bd-0
00:10:07.840 --> 00:10:11.040
So what will happen is if it get more
than 100,

edfe6f52-42fa-40f2-8a24-0b4d326845bd-1
00:10:11.040 --> 00:10:14.240
the logic app will start dropping the
triggers.

24f73da1-b19d-4b61-acc9-81580733296f-0
00:10:14.240 --> 00:10:18.000
So, so 101 get dropped.

5fbacbf8-77a7-4f8b-96bc-b7ac62238ff9-0
00:10:18.720 --> 00:10:26.280
So until one git process from the queue,
so which is not really ideal, right?

0eedc2d4-b4ef-4d7e-977f-757073213810-0
00:10:26.280 --> 00:10:30.840
So I think in the future what we should
is get rid of this for Logic app.

3c34bbb1-b4a1-4ba7-ad3f-312a3e7130bc-0
00:10:33.240 --> 00:10:35.200
So we don't need any concurrency.

c1c64fe6-51ad-4511-a13d-680429fb617c-0
00:10:35.600 --> 00:10:38.400
So Logic app is very lightweight, right?

3cd7f92a-f6ad-42c7-a965-c17b41c72efa-0
00:10:38.400 --> 00:10:44.417
So the Logic app will only do the
business logic and the heavy lifting,

3cd7f92a-f6ad-42c7-a965-c17b41c72efa-1
00:10:44.417 --> 00:10:48.680
copying the file will be done by the
function app.

d92c42b5-1491-4f22-b306-219005348fcc-0
00:10:49.280 --> 00:10:53.040
So,
So what will happen is so I've sort of.

b45879c7-0b64-4985-8fe0-7ca2ac624fb4-0
00:10:54.000 --> 00:10:57.000
So this is sort of like the production
version of the Logic app, right?

6192db4b-3387-4884-97f4-7688754e56bf-0
00:10:57.000 --> 00:11:02.760
So I've got a copy of the previous Logic
app.

cf4100ab-286b-4dc8-8787-04298d4162e0-0
00:11:04.000 --> 00:11:10.855
And in that Logic app,
there's a I've I've,

cf4100ab-286b-4dc8-8787-04298d4162e0-1
00:11:10.855 --> 00:11:20.360
I've changed that to to publish the queue
message somewhere.

fda04324-17c5-44bf-baf0-9b5cbecb1a03-0
00:11:24.160 --> 00:11:25.320
Yeah, so this one here.

dc33e80d-d8c2-4e35-94bb-cd624f92730e-0
00:11:25.880 --> 00:11:33.723
So it's pretty much so this is the
SharePoint storage and this is the queue

dc33e80d-d8c2-4e35-94bb-cd624f92730e-1
00:11:33.723 --> 00:11:34.240
name.

94509122-5ca0-4128-9807-f80655ab3d1c-0
00:11:34.800 --> 00:11:38.320
And this content get published into the
queue message.

ecae2606-02a7-414c-a819-388fd03952e2-0
00:11:38.320 --> 00:11:44.400
So you will tell the source file path and
the destination file path.

4d2e539b-0807-4b4b-af62-19d5732875c3-0
00:11:44.680 --> 00:11:48.080
And you know,
correlation ID is the record ID.

f0d136a2-3cf2-464c-8121-93c2de4387c4-0
00:11:48.080 --> 00:11:56.304
So then the sort of function app can
track which record is this file related

f0d136a2-3cf2-464c-8121-93c2de4387c4-1
00:11:56.304 --> 00:11:58.120
to sort of thing.

a6f6fde1-bdf7-4375-b60f-b3169ce57970-0
00:11:59.800 --> 00:12:04.600
So so this is the the BLOB storage part
and this is the SharePoint part.

50706992-0aa3-46ea-9d6b-6923bea83c7e-0
00:12:04.720 --> 00:12:10.280
It'll just it'll read and copy the file
into it.

4d383da0-1939-4339-ac1c-2066eeadd581-0
00:12:11.160 --> 00:12:19.217
But I know that in the newer version of
the Logic app you guys done some metadata,

4d383da0-1939-4339-ac1c-2066eeadd581-1
00:12:19.217 --> 00:12:19.800
right?

a71321a6-589d-458e-8df1-3f484a13fa3b-0
00:12:19.800 --> 00:12:29.000
So what I've done is I've extended
function app to accept.

3215b9ad-7c8f-4993-bb57-0a620d7f52f9-0
00:12:29.440 --> 00:12:34.640
So the new sort of structure for the
queue message is.

cf32b7c0-01b7-47bf-b364-58aacc76002f-0
00:12:35.440 --> 00:12:39.600
So we can I've introduced A metadata
element.

ec1a0e59-0965-4748-a053-c967a88be69a-0
00:12:41.240 --> 00:12:43.800
So all the columns.

ed67b318-1b88-4386-a0c4-717c8c01e5f6-0
00:12:43.800 --> 00:12:49.328
So the metadata attributes that need to
be set on the file can be passed in like

ed67b318-1b88-4386-a0c4-717c8c01e5f6-1
00:12:49.328 --> 00:12:51.240
this into the queue message.

c5a520e7-412c-4bf7-a000-d8662f81402d-0
00:12:52.160 --> 00:12:59.527
So then what will happen is function app
will copy the file after copying,

c5a520e7-412c-4bf7-a000-d8662f81402d-1
00:12:59.527 --> 00:13:06.010
after copying the file,
it will set it's it's it's not like after

c5a520e7-412c-4bf7-a000-d8662f81402d-2
00:13:06.010 --> 00:13:07.680
copying the file.

8a96adc8-410f-4dbb-a7ed-48389ce01c2b-0
00:13:07.680 --> 00:13:10.320
So I'll get to the technicality of it.

68d8d93d-dc9c-45fd-8d78-00c6f862a808-0
00:13:10.320 --> 00:13:15.324
So create the file first,
put the columns in and then start copying

68d8d93d-dc9c-45fd-8d78-00c6f862a808-1
00:13:15.324 --> 00:13:17.680
the start streaming the content.

b969a2ae-db6d-4a48-9798-cc9ee0dd1e13-0
00:13:18.520 --> 00:13:20.120
That's how it would work.

320b8247-49cb-43a9-a47f-1824f356b1f3-0
00:13:20.560 --> 00:13:28.600
So there's the example does not have this
bit but in in the logic app, so recap.

dfcad1fc-5756-457d-83c0-3e9ba1780c9e-0
00:13:28.960 --> 00:13:36.000
So this JSM need to change to this format.

8aaecbab-106e-4b73-9a26-ad35df8dc692-0
00:13:36.440 --> 00:13:42.328
So you can,
I can see in this the new workflow,

8aaecbab-106e-4b73-9a26-ad35df8dc692-1
00:13:42.328 --> 00:13:49.197
new workflow,
you have number of variables to read that

8aaecbab-106e-4b73-9a26-ad35df8dc692-2
00:13:49.197 --> 00:13:56.189
metadata, right,
So that you can use that Jason and then

8aaecbab-106e-4b73-9a26-ad35df8dc692-3
00:13:56.189 --> 00:13:58.520
set these whatever.

418dd11a-3ec2-4357-ac4f-c68e1d9aeb1d-0
00:13:59.640 --> 00:14:02.216
Yeah,
it will be like after the create should

418dd11a-3ec2-4357-ac4f-c68e1d9aeb1d-1
00:14:02.216 --> 00:14:03.560
be some update property.

e25921ba-b7bb-4315-a4fe-b4d762241438-0
00:14:05.200 --> 00:14:08.640
You're doing update to SharePoint already,
right?

a532e59c-4d60-4fae-894d-fbdb41029859-0
00:14:09.080 --> 00:14:11.400
Yeah, yeah, yeah.

caf11ffe-474c-4301-a25a-9a8fc4c82d38-0
00:14:11.760 --> 00:14:13.200
It's similar to that.

0e80f85c-542c-481c-95b0-01856baaef6d-0
00:14:13.200 --> 00:14:17.640
Just set the metadata in in your.

1c273d4c-9e8a-4158-9d63-b0fb1cb7c573-0
00:14:17.640 --> 00:14:22.397
So I think the simplest thing,
I was trying to sort of do a bit of

1c273d4c-9e8a-4158-9d63-b0fb1cb7c573-1
00:14:22.397 --> 00:14:26.160
refactoring on it,
but I don't think I'll get to it.

c8ba51bb-7de3-44e4-b601-9f3fd15e8ec9-0
00:14:26.160 --> 00:14:26.840
So Yep.

2a25b888-2fd4-4e9e-b8e3-a86e8f18eac7-0
00:14:27.000 --> 00:14:31.840
So instead of create file, create file,
I need to call the function app, right?

ef526eb5-d239-4a97-931b-78b49adc307f-0
00:14:31.840 --> 00:14:32.600
We need to call it.

db1a77bc-b121-477d-85e0-8d8f68c11143-0
00:14:33.000 --> 00:14:35.160
You need to call the queue queue.

517743aa-9831-40bc-b38c-b068f27a8ac5-0
00:14:35.160 --> 00:14:37.522
Yep, Yeah,
you publish the message to queue,

517743aa-9831-40bc-b38c-b068f27a8ac5-1
00:14:37.522 --> 00:14:38.520
so there's no need.

dc7c5a86-6783-4e2f-8e07-27fe6b779d4d-0
00:14:38.600 --> 00:14:41.800
Wherever you read the file,
there's no need to read the file anymore.

1a228a95-707e-44fb-8ac9-3f703a8e3e9b-0
00:14:42.240 --> 00:14:42.360
Yep.

6a76650d-e96d-433a-96cb-9655d59cf4bc-0
00:14:43.640 --> 00:14:50.918
The only thing is similar to that example,
you can follow that example and publish

6a76650d-e96d-433a-96cb-9655d59cf4bc-1
00:14:50.918 --> 00:14:52.760
the message to queue.

072fdf75-86b7-43d6-9db1-aa8421fb6d0a-0
00:14:52.880 --> 00:14:59.656
So queue is lot longer than what that out
of the box Logic app skew it it it can

072fdf75-86b7-43d6-9db1-aa8421fb6d0a-1
00:14:59.656 --> 00:15:05.679
break like keep thousands and thousands
of messages in the queue if the

072fdf75-86b7-43d6-9db1-aa8421fb6d0a-2
00:15:05.679 --> 00:15:07.520
throughput is so high.

813de774-a7a9-4df8-a412-cd7c444561c0-0
00:15:08.160 --> 00:15:12.214
So and then this log, sorry Dhanukar,
this Logic app will not wait for any

813de774-a7a9-4df8-a412-cd7c444561c0-1
00:15:12.214 --> 00:15:13.080
response, right?

47981a51-7601-47ed-9c72-765929790af3-0
00:15:13.080 --> 00:15:14.440
We want to send to queue.

c3e1b428-f3ad-4d4a-8c51-91d72d007b48-0
00:15:14.440 --> 00:15:16.760
So we can't track it whether it's created
or not.

d0fb1277-0c9f-4b94-8ee3-2ecb5de5523b-0
00:15:17.360 --> 00:15:18.760
How do we from the Logic app?

c015a6d8-ee62-4ee7-926e-93c93c41d282-0
00:15:18.760 --> 00:15:19.320
You can't.

80de1fca-1dac-4e26-b93a-a1e58bcc1307-0
00:15:19.360 --> 00:15:21.120
Logic app is just far and forget.

535b3078-9bd7-4508-8ade-179398fac1cc-0
00:15:22.000 --> 00:15:25.120
Yeah, OK.

393f1500-b91e-4018-8456-fd7e842936a8-0
00:15:25.240 --> 00:15:26.720
Do you see a issue with that?

c8fb9045-5286-4da3-87a3-1f634bbdd3d8-0
00:15:27.400 --> 00:15:32.919
Because one of the requirement grant was
saying that once the document is copied

c8fb9045-5286-4da3-87a3-1f634bbdd3d8-1
00:15:32.919 --> 00:15:37.280
then should be some trigger saying that
that document's placed.

95d7d5d9-27b6-42f1-a55e-8080d5480e54-0
00:15:37.320 --> 00:15:40.720
This this is just for error handling
thing.

aa8bae62-e471-4c69-a2a1-2bb62aa3ffbe-0
00:15:40.720 --> 00:15:44.831
If any file missed it,
how do we know that there is 100 files be

aa8bae62-e471-4c69-a2a1-2bb62aa3ffbe-1
00:15:44.831 --> 00:15:46.160
transferred to queue?

a7c3bf18-93fe-418a-b590-45b2ca9e2c0d-0
00:15:46.360 --> 00:15:51.240
So yeah for some reason for network issue
or something we are getting some failure.

63c1ff0c-d704-47a0-8a67-59a18ad85525-0
00:15:51.280 --> 00:15:52.960
How we can handle that?

a89e29b4-27f5-438b-9aa0-a2e83a782ee3-0
00:15:52.960 --> 00:15:55.960
How we logic app know that this file is
not copied?

6d752a13-82b1-460c-9e85-0d5c79853a3c-0
00:16:00.400 --> 00:16:03.981
So,
so where does grant want to see that

6d752a13-82b1-460c-9e85-0d5c79853a3c-1
00:16:03.981 --> 00:16:04.680
failure?

f2899a04-3ac7-4a22-acf1-b462f73979f3-0
00:16:07.280 --> 00:16:09.120
Is there any way we can see the failure?

334d7a64-db0d-4df4-89d2-02ad5fe0fd52-0
00:16:09.520 --> 00:16:12.400
Yeah, we can,
we can like function app can log it right.

0b18d748-66cc-4299-a39e-debc9a6b9f19-0
00:16:12.600 --> 00:16:15.060
So,
so you you saw that correlation ID is

0b18d748-66cc-4299-a39e-debc9a6b9f19-1
00:16:15.060 --> 00:16:16.760
passed into the function app.

7df1b046-ba69-42d0-b0f4-d734ba11e273-0
00:16:16.760 --> 00:16:22.845
So that means function app knows the
student response, which response it is,

7df1b046-ba69-42d0-b0f4-d734ba11e273-1
00:16:22.845 --> 00:16:23.320
right?

049835ac-f99e-44f2-85aa-58295781dd33-0
00:16:24.360 --> 00:16:24.480
Yeah.

5edef24c-8a1c-46b0-a3b9-d5155623b6ea-0
00:16:24.720 --> 00:16:26.680
So function app can do whatever, right?

6daa072e-c411-4ea0-9c0d-2cf6dba62e64-0
00:16:26.680 --> 00:16:30.611
So function app, so if there is a failure,
so once we move to the queue,

6daa072e-c411-4ea0-9c0d-2cf6dba62e64-1
00:16:30.611 --> 00:16:33.520
the function of the connection won't be
there, right?

7a4eb3f5-b682-4377-b87f-1043c0544e19-0
00:16:34.720 --> 00:16:35.120
To the logic.

8b9d0b16-1a3e-4b48-ae09-927a74e34dbc-0
00:16:35.320 --> 00:16:36.400
So you don't have to.

bc441d91-39ec-4324-8fe5-afcc485f1904-0
00:16:36.480 --> 00:16:40.920
So that's why I'm asking where does grant
want to see that failure, right.

33a8ff17-83c3-49d3-9a12-d08c68bdd48a-0
00:16:40.920 --> 00:16:46.785
So if you want to see that failure in the,
so in the current anywhere like email

33a8ff17-83c3-49d3-9a12-d08c68bdd48a-1
00:16:46.785 --> 00:16:49.320
notification, whatever, yeah, yeah.

462c494c-9983-4f36-bc92-04b8e562fbd2-0
00:16:49.360 --> 00:16:52.000
So if we've got the current logic Apps,
we have action, right?

c9d6527e-cb6b-4d09-a3a9-ea30ad3924e2-0
00:16:52.000 --> 00:16:55.729
If some action failed,
we can capture it and do and send email

c9d6527e-cb6b-4d09-a3a9-ea30ad3924e2-1
00:16:55.729 --> 00:16:59.814
to some ask work people saying that this
flow failed with this file,

c9d6527e-cb6b-4d09-a3a9-ea30ad3924e2-2
00:16:59.814 --> 00:17:00.880
we're creating it.

d8b99b2f-c7ca-4188-be68-f2edc6d9258c-0
00:17:01.280 --> 00:17:01.440
Yeah.

cd53a82d-4025-4d64-ab40-579038f31884-0
00:17:01.520 --> 00:17:05.720
So this kind of requirement came recently,
but not before.

978932d2-bf12-4857-a245-7d0f958c88da-0
00:17:06.040 --> 00:17:06.160
Yeah.

adaa3dae-c333-4848-b610-842cdd80cf92-0
00:17:06.160 --> 00:17:09.683
So grandpa's asking is there any way
because we are sending the all the

adaa3dae-c333-4848-b610-842cdd80cf92-1
00:17:09.683 --> 00:17:10.760
requests to the queue.

0b1b81e3-53b8-4d56-a71d-3459aa5ff2d4-0
00:17:10.840 --> 00:17:14.077
But yeah,
we don't have any success message back or

0b1b81e3-53b8-4d56-a71d-3459aa5ff2d4-1
00:17:14.077 --> 00:17:17.501
once it's copied,
we need the confirmation whether the

0b1b81e3-53b8-4d56-a71d-3459aa5ff2d4-2
00:17:17.501 --> 00:17:19.680
file's placed in SharePoint or not.

2da1c7ae-3b9c-431a-b703-be9844f7f5ba-0
00:17:19.760 --> 00:17:22.280
Yeah, that's the thing I'm after.

3ce23f4f-7453-4a0a-acc6-2ac2dbaf5dd4-0
00:17:22.360 --> 00:17:22.480
Yeah.

14115497-a1d2-4250-9b35-152bfe1e762a-0
00:17:22.480 --> 00:17:26.640
So,
so in that case how I would implement is

14115497-a1d2-4250-9b35-152bfe1e762a-1
00:17:26.640 --> 00:17:32.280
logic app triggers logic app publishes
the message to queue.

47ef7e43-c5bd-46f0-b658-47b1e1d02835-0
00:17:33.360 --> 00:17:37.760
Eventually that queue message get picked
up a function app and will copy the file.

fc3b5bae-41a1-4568-b62e-3347bd1eaa98-0
00:17:38.280 --> 00:17:42.226
After copying the file,
the function app can if function app

fc3b5bae-41a1-4568-b62e-3347bd1eaa98-1
00:17:42.226 --> 00:17:47.338
fails to copy the file for some reason
network issue or some issue permissions

fc3b5bae-41a1-4568-b62e-3347bd1eaa98-2
00:17:47.338 --> 00:17:50.120
issue,
it fails to copy the file logic app

fc3b5bae-41a1-4568-b62e-3347bd1eaa98-3
00:17:50.120 --> 00:17:54.520
function app can trigger another logic
app to send the email email.

bf64215a-0feb-4964-b794-7c85e961474b-0
00:17:56.000 --> 00:17:59.212
OK,
so you can have a email logic app error

bf64215a-0feb-4964-b794-7c85e961474b-1
00:17:59.212 --> 00:18:00.600
handling logic app.

630efd93-6406-433f-914c-bbdd401b0b8e-0
00:18:01.120 --> 00:18:04.160
You can call back so,
so this logic app will finish right?

4b5b263c-d1d8-4a2d-8a24-18a7e696be8e-0
00:18:04.320 --> 00:18:10.469
So you can have a simpler error handling
logic app function app can call on error,

4b5b263c-d1d8-4a2d-8a24-18a7e696be8e-1
00:18:10.469 --> 00:18:10.840
yeah.

2d461fd2-c597-4d40-9472-64589cee8c87-0
00:18:10.880 --> 00:18:15.612
So but where it's not implemented, right,
we have to no, no, it's not implemented,

2d461fd2-c597-4d40-9472-64589cee8c87-1
00:18:15.612 --> 00:18:16.240
yeah, yeah.

d5c03956-0f08-4601-b9dd-4000eb94d334-0
00:18:16.240 --> 00:18:17.760
But this wasn't a requirement, right?

83e10335-19eb-4d85-9f85-694c42b99864-0
00:18:17.760 --> 00:18:19.720
So yeah, yeah, got it.

205c2b29-5889-499a-8ba4-01949e9dbaca-0
00:18:19.840 --> 00:18:21.440
The one yeah, yeah.

ccc719d0-5faf-47c8-846d-b551bb5ede62-0
00:18:21.600 --> 00:18:22.400
In future 1.

6eacb788-3c71-4a82-98e8-05bb5bc0c67c-0
00:18:22.400 --> 00:18:24.120
So you could do that.

c74a14d6-fd96-400c-bdb9-15fede622909-0
00:18:24.440 --> 00:18:29.440
So this function app will just call
trigger 10 messages, right?

4e1d1c5e-ff66-4024-ba0b-73c7e8c6fd21-0
00:18:29.440 --> 00:18:30.520
It'll be very quick, right.

f258e993-e31d-413c-a9a9-8be7fcadb081-0
00:18:30.520 --> 00:18:33.060
So no,
we don't want any delays or anything like

f258e993-e31d-413c-a9a9-8be7fcadb081-1
00:18:33.060 --> 00:18:33.320
that.

fea743f9-d6db-4694-a762-3b0fbde3ef6c-0
00:18:34.320 --> 00:18:40.400
Just file right, run the business logic,
fire, fire, fire, finish up.

944d82ca-57f1-4c96-bb21-e36dbd15d47e-0
00:18:41.400 --> 00:18:43.480
Eventually the files get copied.

68e4619a-ed2a-4e69-8469-9b3a91a2256c-0
00:18:44.400 --> 00:18:50.461
If doesn't get copied,
then change the function app logic to

68e4619a-ed2a-4e69-8469-9b3a91a2256c-1
00:18:50.461 --> 00:18:53.840
trigger another trigger logic app.

338bd2a1-a720-4f68-9e9b-98cfe39c0236-0
00:18:54.040 --> 00:18:57.083
So you,
you you have multiple ways to function

338bd2a1-a720-4f68-9e9b-98cfe39c0236-1
00:18:57.083 --> 00:19:00.840
app can send mail,
also email function app can send mail.

7d55b903-b7f9-4015-93eb-06c75a9bfcf9-0
00:19:00.840 --> 00:19:03.160
But you need a SMTP server, right?

0ba35703-a652-429b-9562-201df14a730b-0
00:19:03.920 --> 00:19:04.040
Yeah.

d46fc344-42c1-4918-b1bd-46279474c72b-0
00:19:04.560 --> 00:19:09.364
So that, that I think you,
you guys already probably have that right

d46fc344-42c1-4918-b1bd-46279474c72b-1
00:19:09.364 --> 00:19:13.542
in the Logic app,
the Logic app we're using out of the box,

d46fc344-42c1-4918-b1bd-46279474c72b-2
00:19:13.542 --> 00:19:13.960
right.

2578bff8-c81d-47d4-85ae-c46c49af7ad3-0
00:19:13.960 --> 00:19:16.200
But this Logic app will not send any
email.

debfa99c-dea7-4c09-ab11-d0f943dc06e8-0
00:19:16.480 --> 00:19:19.720
So only the power automate,
we are handling that email functionality.

1c616597-64e1-404e-b810-bdad0973b4c0-0
00:19:20.200 --> 00:19:24.272
So, yeah, so,
so you need to trigger a power domain,

1c616597-64e1-404e-b810-bdad0973b4c0-1
00:19:24.272 --> 00:19:26.040
not a logic app, right?

fedfd50b-128f-42a9-8be6-412b67dc2a4e-0
00:19:26.360 --> 00:19:26.640
Yeah.

3ce570ea-f980-423c-9cca-a01faef074e8-0
00:19:26.680 --> 00:19:30.110
When any error comes,
then power OTP needs to be triggered

3ce570ea-f980-423c-9cca-a01faef074e8-1
00:19:30.110 --> 00:19:31.680
instead of logic app, Yeah.

ac069565-5191-45da-9845-e992ed884373-0
00:19:31.760 --> 00:19:37.288
So likewise this function app does not
have default email provider, right,

ac069565-5191-45da-9845-e992ed884373-1
00:19:37.288 --> 00:19:38.320
SMSMTP server.

6f9f0847-ee2c-40c6-9aa4-14a40b084b8c-0
00:19:38.840 --> 00:19:42.240
But there'll be lot of work to configure
function app can do it.

994cfa97-a360-45b8-b60a-65a95c0fb608-0
00:19:42.880 --> 00:19:46.320
The thing is then SMTP setup is, yeah,
need to be there.

95399317-3b40-4c04-8537-b281b7e118e1-0
00:19:46.920 --> 00:19:47.200
Yeah.

a9ad8bae-182c-46e4-b08e-c3c3fef0bb5a-0
00:19:47.400 --> 00:19:48.400
So we don't want that.

7e02f6f6-4ae4-42e4-a75a-d8efb6160b0a-0
00:19:48.400 --> 00:19:51.211
But already we have,
we are sending through from our power

7e02f6f6-4ae4-42e4-a75a-d8efb6160b0a-1
00:19:51.211 --> 00:19:51.640
automate.

15fc494e-2029-4342-b07b-21c810a0cf4c-0
00:19:51.840 --> 00:19:52.160
Yeah.

bd7bb824-8ebf-4145-bb17-90afae2f882b-0
00:19:52.160 --> 00:19:55.950
Then I should prefer like we will go with
function app should call the power

bd7bb824-8ebf-4145-bb17-90afae2f882b-1
00:19:55.950 --> 00:19:57.920
automate in case of any failure to copy.

bd669584-982f-417b-bdb9-9b7bbd4dfc08-0
00:19:57.920 --> 00:19:58.760
Yeah, yeah, yeah.

cf0d7b82-fbf1-4833-99ee-347fd35c8387-0
00:19:59.080 --> 00:19:59.880
That's the easiest.

0f0d12ad-05ff-4099-a0b0-26e9b4ab583f-0
00:19:59.880 --> 00:20:00.760
That's the easiest way.

cb21be5a-454d-4453-af35-128280af4df9-0
00:20:00.840 --> 00:20:04.541
So then instead of calling the logic app
for handling,

cb21be5a-454d-4453-af35-128280af4df9-1
00:20:04.541 --> 00:20:06.560
we'll call the power automate.

58f84e3d-66a5-4abb-be5a-ad981df04589-0
00:20:08.000 --> 00:20:08.280
Yeah, yeah.

86994c09-a3c7-4c7f-818c-091bc6573bd0-0
00:20:09.520 --> 00:20:09.760
Cool.

58aa883a-0111-4ae9-967f-f2bcbacf287e-0
00:20:10.640 --> 00:20:14.360
So I think that's the changes required
for the function app.

9cf1d379-a2fc-48e3-8ae2-405423b6cf14-0
00:20:15.520 --> 00:20:23.200
Function app is already deployed onto
onto dev environment.

274a2178-e277-4634-90df-fc2a5110a368-0
00:20:23.400 --> 00:20:30.570
I think we're running out of time,
so I'll just quickly take you guys

274a2178-e277-4634-90df-fc2a5110a368-1
00:20:30.570 --> 00:20:34.360
through the code record view of code.

64315d86-7718-46ee-8d6f-294624bcf784-0
00:20:39.960 --> 00:20:44.120
So, so the, the the it's pretty basic,
right?

803a5ddf-9323-4210-a5fb-3d79e044b2ba-0
00:20:44.120 --> 00:20:50.580
So file source,
we have the source part from the Jason

803a5ddf-9323-4210-a5fb-3d79e044b2ba-1
00:20:50.580 --> 00:20:57.040
and file source initiated,
file destination initiated.

a07721dc-5678-454e-a0f2-8214210f347f-0
00:20:57.520 --> 00:20:59.720
And so we have a threshold.

572d1a38-95b1-445c-971c-e8e0d11a389c-0
00:21:01.160 --> 00:21:03.960
So currently threshold is set to 4
megabytes.

4f9780d8-dd9d-432d-8b7c-02592af62eb4-0
00:21:05.040 --> 00:21:11.908
So if it is less than 4 megabytes then
full copy so that it's not a big file,

4f9780d8-dd9d-432d-8b7c-02592af62eb4-1
00:21:11.908 --> 00:21:16.400
you're just going to copy the whole file
as it is.

672dd9ed-8bc4-4422-b8ad-a8d83d1e1c12-0
00:21:17.160 --> 00:21:24.080
If it is over 4 megabyte then chunk copy
will happen.

a96145df-dd09-44b6-9e22-5065d3845f3f-0
00:21:26.760 --> 00:21:36.270
So what it pretty much does is has logic
to divide the file size into that chunk

a96145df-dd09-44b6-9e22-5065d3845f3f-1
00:21:36.270 --> 00:21:37.680
size for MB.

98227b78-db3a-4e51-9a63-69d0f08d50cf-0
00:21:37.960 --> 00:21:42.000
And the first thing it does is it creates
the file.

c61ef823-e584-45a3-be0f-0ad7637ea35d-0
00:21:42.360 --> 00:21:47.906
So if you go to the create file,
create file,

c61ef823-e584-45a3-be0f-0ad7637ea35d-1
00:21:47.906 --> 00:21:57.432
so you can see there's it's using the
SharePoint REST API and uses another app

c61ef823-e584-45a3-be0f-0ad7637ea35d-2
00:21:57.432 --> 00:21:59.000
registration.

b11b4fd3-b470-4ab4-ac36-d8966b07bce9-0
00:21:59.000 --> 00:21:59.360
It doesn't.

3dbef803-3203-4a34-a204-1d30ab14fc30-0
00:21:59.360 --> 00:22:01.800
So I think that's one of the key
differences.

106534cc-a83e-41c0-9fb1-115c8a0976f2-0
00:22:02.280 --> 00:22:06.480
Logic app uses a user to log into
SharePoint function.

c7be6573-69e1-4d3b-a9ee-054ef40c3071-0
00:22:06.480 --> 00:22:07.520
App doesn't use a user.

26af6b91-8b4e-451a-873a-7345bf329854-0
00:22:08.080 --> 00:22:12.880
It's not good practise to use a user for
a system integration.

ac91d421-de51-4dc4-8a7a-38e12b0da548-0
00:22:13.360 --> 00:22:14.640
So we don't do that anymore.

c40ef1e4-e504-417a-bc87-e38d904645c2-0
00:22:14.640 --> 00:22:16.440
So we have app registration.

6dc63832-cbf0-4cb0-bad9-c58ba4f2e23d-0
00:22:16.560 --> 00:22:23.732
We use app registration to get a access
token and use the access token to hit the

6dc63832-cbf0-4cb0-bad9-c58ba4f2e23d-1
00:22:23.732 --> 00:22:24.520
REST API.

b74fd61e-f41e-4ce7-a3c9-2c4da3666ebd-0
00:22:27.040 --> 00:22:29.800
So,
so the first thing is to create the file.

c7dfb1f2-01af-4682-85fa-11549d71c6f8-0
00:22:29.800 --> 00:22:36.907
So that's sort of like a shell file
without any content in it and then add

c7dfb1f2-01af-4682-85fa-11549d71c6f8-1
00:22:36.907 --> 00:22:37.760
metadata.

18af93c0-bc94-4771-916d-28008d9a2ea4-0
00:22:38.840 --> 00:22:45.800
So if, if, if the Jason have metadata,
then it does set the metadata in it.

be7eb021-c7c3-47ab-87a8-5f3131fea1b9-0
00:22:47.400 --> 00:22:53.381
And so if we go back,
so that's so shell files created with

be7eb021-c7c3-47ab-87a8-5f3131fea1b9-1
00:22:53.381 --> 00:22:59.064
some metadata,
after shell file is created then it start

be7eb021-c7c3-47ab-87a8-5f3131fea1b9-2
00:22:59.064 --> 00:23:00.560
reading chunks.

6efcf7b4-1a55-43d8-97b3-1c4416a69161-0
00:23:00.560 --> 00:23:05.720
So it reads a chunk and copied the chunk
to SharePoint.

820f8163-45cf-42b5-bd46-096f0b8ca543-0
00:23:07.520 --> 00:23:16.280
So if I go here, yeah,
so it has rest of basis.

f6866e80-ce62-4cb5-878b-4f6e079cc368-0
00:23:16.280 --> 00:23:19.640
So there's a few endpoints in SharePoint.

a2421f74-228b-4ae4-9d4d-ddae112209c3-0
00:23:19.640 --> 00:23:27.182
So you can start continue until so when
the last chunk is detected,

a2421f74-228b-4ae4-9d4d-ddae112209c3-1
00:23:27.182 --> 00:23:32.840
it finish off the file upload in in in
SharePoint.

0e0c8a89-f515-466a-b7a5-91969de096d0-0
00:23:32.840 --> 00:23:37.280
So it it sort of I think SharePoint sort
of finalise the file.

9159e200-4aec-4341-ae0d-40754bb82309-0
00:23:40.600 --> 00:23:43.920
Yeah,
that's that's that's all file copies.

0b5f446c-1669-4ea0-8d5a-4385ef7a2768-0
00:23:45.520 --> 00:23:49.840
So you can run this function up locally
for example.

473fe77a-15b2-4f33-b19d-d455da1e068e-0
00:23:52.080 --> 00:24:02.646
So if I run this function app locally
charging the the tricky part here is ask

473fe77a-15b2-4f33-b19d-d455da1e068e-1
00:24:02.646 --> 00:24:04.920
our set up right?

8671afab-c655-43ff-9ce6-766982985946-0
00:24:04.920 --> 00:24:11.169
Ask your environment to ask anything that
you want to run from programme files in

8671afab-c655-43ff-9ce6-766982985946-1
00:24:11.169 --> 00:24:12.160
your machine.

5ef5ca10-cbb9-4f29-8a25-bc307640ab62-0
00:24:14.760 --> 00:24:21.080
It need to be whitelisted by the ask for
security guys, right?

e9f8afe4-a017-4cf3-a245-c7502e359451-0
00:24:22.560 --> 00:24:27.088
So when you debug a function app,
so function app,

e9f8afe4-a017-4cf3-a245-c7502e359451-1
00:24:27.088 --> 00:24:34.547
the way that function app runs locally is
there's sort of like it's executable core

e9f8afe4-a017-4cf3-a245-c7502e359451-2
00:24:34.547 --> 00:24:40.318
function Co app core tools,
function core tools get run and your

e9f8afe4-a017-4cf3-a245-c7502e359451-3
00:24:40.318 --> 00:24:43.160
function will get run inside it.

9180d871-4205-444d-bc40-926e4cf76953-0
00:24:44.040 --> 00:24:50.333
But this function core tools is installed
with Visual Studio and programme files

9180d871-4205-444d-bc40-926e4cf76953-1
00:24:50.333 --> 00:24:56.472
and Visual Studio does updates to this
core tools time to time the version get

9180d871-4205-444d-bc40-926e4cf76953-2
00:24:56.472 --> 00:24:57.560
updated right?

0cd9275d-e3c1-467a-bbad-36f637cdaef2-0
00:24:58.080 --> 00:24:59.600
It it updating frequently.

faf355fd-3669-42c1-a516-36095a8ac475-0
00:24:59.600 --> 00:25:03.400
Every week or two weeks the core tools
get a new version.

500f718a-68bd-4e1c-98f1-3d3ffa5de397-0
00:25:04.240 --> 00:25:05.880
So what happens is.

3d2aad5c-f433-4c10-92c0-624a562d6d25-0
00:25:06.480 --> 00:25:14.223
So you need to call the you need to raise
service test requests every time the

3d2aad5c-f433-4c10-92c0-624a562d6d25-1
00:25:14.223 --> 00:25:17.360
function core tools get changed.

4be5251e-2d31-4c6a-be70-cb898b64b862-0
00:25:17.600 --> 00:25:19.600
Yeah, yeah, install, don't you?

3e9c2903-f19a-4b9d-a76a-51a14985a452-0
00:25:19.600 --> 00:25:22.640
Because we should do automatically
installs it, right?

6a56dc01-1a33-4b0b-b997-3f821b19ac41-0
00:25:22.640 --> 00:25:26.920
So whenever there there's a new version
and your function apps stop working.

5361df0c-45e9-4fa7-8490-f02135ea921f-0
00:25:28.560 --> 00:25:30.120
So what type of request you raise?

ba5861d4-7b25-4521-a89d-4e050dbfe04c-0
00:25:30.120 --> 00:25:32.560
Like how do you explain this problem to
them?

b222b9e3-4243-4541-a25b-42e7402d0848-0
00:25:32.640 --> 00:25:36.400
They are already aware of it or do you
they already aware of it.

253398c6-9e35-48bb-8d3f-82711dfcfcf3-0
00:25:36.400 --> 00:25:44.259
You just raise a support ticket to
requesting the latest core version to be

253398c6-9e35-48bb-8d3f-82711dfcfcf3-1
00:25:44.259 --> 00:25:49.120
function code rules version to be
whitelisted.

6efd191f-0876-44c2-989b-6b489c8d3dac-0
00:25:50.000 --> 00:25:54.240
OK, this I'll try to find the article.

5856d298-9708-4044-a07e-56139ffc232b-0
00:25:54.240 --> 00:25:58.400
There's so so so when.

930064a8-3672-45a2-a468-e91e33540aa5-0
00:25:59.200 --> 00:26:01.332
OK,
this is the other thing that I should

930064a8-3672-45a2-a468-e91e33540aa5-1
00:26:01.332 --> 00:26:01.840
highlight.

e04298fb-3577-4ff9-8f18-dad8b184bd46-0
00:26:02.680 --> 00:26:08.880
When you set up,
so when you initially set up your machine.

53c491b2-8bbc-47aa-a1d0-881f47d0b354-0
00:26:09.520 --> 00:26:12.556
So Dave,
if if you say you are a developer,

53c491b2-8bbc-47aa-a1d0-881f47d0b354-1
00:26:12.556 --> 00:26:15.040
they will set up a developer folder.

94856e16-1d53-4e70-90d2-7d27a16a44cc-0
00:26:15.600 --> 00:26:15.720
Yep.

33031da9-9bea-4850-ba8b-7ab453f0d2a4-0
00:26:16.240 --> 00:26:21.202
So every development that you do,
every apior.net code that you run,

33031da9-9bea-4850-ba8b-7ab453f0d2a4-1
00:26:21.202 --> 00:26:24.080
you need to run in the developer folder.

fb228576-fdfe-4693-81a9-74401cd3339c-0
00:26:25.040 --> 00:26:25.200
Yep.

95bd5cc1-4ddd-4ea0-b834-4dc3640b7328-0
00:26:25.200 --> 00:26:32.000
So any EXE that you run from developer
folder, they don't block it.

88d7106f-45ce-47e6-a4fb-c43911c667db-0
00:26:32.360 --> 00:26:34.960
So you're free to run anything from here,
right?

ccf253d5-d06b-42f6-9831-f6ca64bb2dc6-0
00:26:36.160 --> 00:26:39.240
So I I found, I'll,
I'll try to find that article again.

579ce301-48bd-47b0-b6d3-69d6685fc8b3-0
00:26:39.320 --> 00:26:42.661
There's a hack,
but then you you need to be a

579ce301-48bd-47b0-b6d3-69d6685fc8b3-1
00:26:42.661 --> 00:26:44.840
administrator of your machine.

8e182ec1-11ed-461b-877e-d957f1c5e490-0
00:26:45.240 --> 00:26:51.126
You need you can change some registry
settings so you can tell Visual Studio

8e182ec1-11ed-461b-877e-d957f1c5e490-1
00:26:51.126 --> 00:26:52.120
don't run it.

544453b0-7a19-45bd-8467-005dde005002-0
00:26:52.240 --> 00:26:57.364
Don't run the core tools from Visual
Studio programme files,

544453b0-7a19-45bd-8467-005dde005002-1
00:26:57.364 --> 00:26:59.800
run it from developer folder.

833b0e8b-098d-4c6a-8e1c-a3d98856aea4-0
00:27:00.480 --> 00:27:07.692
OK So what I've done is you can see I've
copied the function core tools into my

833b0e8b-098d-4c6a-8e1c-a3d98856aea4-1
00:27:07.692 --> 00:27:14.904
developer folder and change the registry
settings so Visual Studio will run the

833b0e8b-098d-4c6a-8e1c-a3d98856aea4-2
00:27:14.904 --> 00:27:18.239
EXE from the from my developer tools.

b253a7c1-49e9-47e7-a497-1539ef68ae81-0
00:27:18.240 --> 00:27:24.840
So nothing get blocked and I won't get
affected by the updates as well.

324775a4-58cd-415b-adbf-9b8254d28968-0
00:27:24.840 --> 00:27:27.200
So I think that's a pretty tricky thing.

05790f54-d87a-450b-9c1d-79f46fadb677-0
00:27:27.200 --> 00:27:30.040
The three settings if you are changing
that need to be admin right.

c59a0a60-fed4-490f-a548-63d92cf7ebc9-0
00:27:30.040 --> 00:27:31.760
So you need to be admin.

449ac099-cc38-4b4e-92f0-81f4dd0a35ba-0
00:27:31.880 --> 00:27:36.080
So I I,
I you do you guys have a_W account?

95639b3d-b3e5-44b5-9a8c-0f91d7ad3c84-0
00:27:36.360 --> 00:27:41.349
I do not_W No,
I don't have it yeah_W is you can get you

95639b3d-b3e5-44b5-9a8c-0f91d7ad3c84-1
00:27:41.349 --> 00:27:43.800
can be admin of the machine.

085f2ebc-6435-4000-aaf8-9d5698858ba5-0
00:27:44.120 --> 00:27:46.400
OK you can request 1.

45c26a2a-fbee-436b-8503-6e7b3576d932-0
00:27:47.080 --> 00:27:49.440
So I request but hardly uses it.

be96844b-1836-4de9-adeb-50552704887d-0
00:27:49.640 --> 00:27:56.144
But OK, you know when you doing.
net stuff you need_W account time to time

be96844b-1836-4de9-adeb-50552704887d-1
00:27:56.144 --> 00:27:58.400
you need to modify things.

3c094a4d-911e-4508-a35a-ae3ab99f97a7-0
00:27:59.320 --> 00:28:00.960
But that will be like a different system,
right?

b35f44c2-edb1-435b-a79e-e7d33b5290e8-0
00:28:00.960 --> 00:28:03.636
Tanuka,
you have to log off your current access

b35f44c2-edb1-435b-a79e-e7d33b5290e8-1
00:28:03.636 --> 00:28:06.480
and then log in back with the W account
and do it.

60393ab7-8734-43f1-a42a-d7d4f80318ec-0
00:28:07.200 --> 00:28:11.240
You can do that or you can run anything
as admin, right?

cfbc76f2-7ad6-46ca-a97b-8c97e3775d46-0
00:28:11.440 --> 00:28:17.280
Run this admin and then you can log in
right, right, right entry.

809d9a1e-5a15-48e0-ad24-d578eb3f0a17-0
00:28:17.280 --> 00:28:24.011
You can Yep press control and go run as
administrator and then you can enter your

809d9a1e-5a15-48e0-ad24-d578eb3f0a17-1
00:28:24.011 --> 00:28:29.840
yeah account and then OK can do things
yeah so so you can run locally.

60d6f430-646a-4d45-9651-8f951a98140a-0
00:28:29.840 --> 00:28:37.896
So remember so the function app,
if all the secrets are read from so

60d6f430-646a-4d45-9651-8f951a98140a-1
00:28:37.896 --> 00:28:41.400
function app needs a a secret.

fffb2542-ba9e-40d8-96ca-866700d59bd2-0
00:28:41.680 --> 00:28:47.760
So all the secrets are stored in in in
keyboard.

95406551-0ce4-4369-a153-acc97507cbad-0
00:28:47.960 --> 00:28:51.675
So,
so even when you run from your local

95406551-0ce4-4369-a153-acc97507cbad-1
00:28:51.675 --> 00:28:56.296
machine,
it will try to connect to Azure keyboard,

95406551-0ce4-4369-a153-acc97507cbad-2
00:28:56.296 --> 00:28:56.840
right?

f61f4b1f-11d4-4005-878c-a68fcd889e36-0
00:28:56.840 --> 00:29:04.158
So, so when you run locally,
you need to make sure that you are

f61f4b1f-11d4-4005-878c-a68fcd889e36-1
00:29:04.158 --> 00:29:05.760
authenticated.

d87e79ed-84ea-4d8e-b2ec-d554ed6ca0d1-0
00:29:07.600 --> 00:29:19.841
So in Visual Studio,
there's a section called Azure Services

d87e79ed-84ea-4d8e-b2ec-d554ed6ca0d1-1
00:29:19.841 --> 00:29:31.079
Authentication,
and you can log in with your_A account,

d87e79ed-84ea-4d8e-b2ec-d554ed6ca0d1-2
00:29:31.079 --> 00:29:40.110
log in to Visual Studio with your_A
account.

60d4045f-14db-411b-9750-2d281a4584c3-0
00:29:40.110 --> 00:29:42.230
So Visual Studio can connect to the
keyboard.

7a51e3c2-ba86-44f4-8b31-a132333f232b-0
00:29:45.350 --> 00:29:45.550
OK.

d526cacd-8091-4987-b387-89ed07a8e6f6-0
00:29:54.290 --> 00:29:56.450
And can you please show us the registry
setting?

b789f697-8a31-46ad-8552-dcf15c1ee73e-0
00:29:56.730 --> 00:29:58.770
Which setting needs to be modified?

1801048b-dbf8-4801-be29-d0d531e67c30-0
00:29:58.890 --> 00:30:00.290
Yeah, probably a screenshot.

eada92b7-5baf-4a43-b8f2-e74c5a2337c9-0
00:30:01.040 --> 00:30:02.400
That's what I can't remember.

c0cf7f30-45bc-4569-9323-37efb8a7df5d-0
00:30:03.720 --> 00:30:06.549
I,
I thought I would not have to do this

c0cf7f30-45bc-4569-9323-37efb8a7df5d-1
00:30:06.549 --> 00:30:12.207
ever again because I had a lot of wishes
because it's not normal to for this kind

c0cf7f30-45bc-4569-9323-37efb8a7df5d-2
00:30:12.207 --> 00:30:14.760
of setup to, you know, get every day.

7d70d2a4-3bdd-4bfe-91e1-9b7b95147e7c-0
00:30:15.240 --> 00:30:17.200
Yeah, I'll, I'll try to find it.

2475393a-0f32-44f7-80ea-2831a9fb57c5-0
00:30:17.520 --> 00:30:21.172
OK,
the vote registry need to be set because

2475393a-0f32-44f7-80ea-2831a9fb57c5-1
00:30:21.172 --> 00:30:23.120
otherwise it's annoying.

b9298257-23d8-4975-a0b9-8bcf33ac0175-0
00:30:23.240 --> 00:30:28.395
Every other week you have to call support
desk and sometimes the people change and

b9298257-23d8-4975-a0b9-8bcf33ac0175-1
00:30:28.395 --> 00:30:30.880
you have to explain it from the scratch.

5e1ddd9b-2618-436b-9b0c-0d11b8a5ae0c-0
00:30:30.880 --> 00:30:36.200
That is what happened and and what they
said was to whitelist.

4f42e06e-5aea-44d1-a36c-f6545f9ae2dd-0
00:30:36.200 --> 00:30:42.196
They have to submit your request to some
Security Council and you need to get that

4f42e06e-5aea-44d1-a36c-f6545f9ae2dd-1
00:30:42.196 --> 00:30:43.280
approved after.

6510d041-6deb-4a7a-8e5e-98dc3f6564bd-0
00:30:43.840 --> 00:30:46.080
You can't pretty much do any development
then.

63bfa145-111d-459c-aedd-f2f444119b15-0
00:30:47.560 --> 00:30:49.560
Yeah, but I'm a blocker.

84eb2de3-a67b-4131-a7ae-2b7ca5327b76-0
00:30:49.720 --> 00:30:51.000
Actually, it's a blocker.

382dd3b9-adef-42b3-8eda-01940e48dc56-0
00:30:51.000 --> 00:30:51.560
It's a blocker.

f30e218f-ffb8-46ea-98af-e2341f85798f-0
00:30:51.640 --> 00:30:56.320
So you need to have that work around to
get the there's.

54d32923-a038-456c-92ac-b89cdd9e0b90-0
00:30:56.520 --> 00:30:57.600
I'll try to find it.

40f2cb02-df8a-4dbf-a32e-43552c5b176b-0
00:30:57.880 --> 00:30:58.440
Oh, thanks.

4702c65f-cdf4-488f-b220-c4f5147f78a8-0
00:30:59.000 --> 00:30:59.120
Yeah.

04c8f889-0b30-4d5c-aa59-2ad44f63e422-0
00:31:00.080 --> 00:31:04.669
So now I'm authenticated,
authenticated my Visual Studio as myself

04c8f889-0b30-4d5c-aa59-2ad44f63e422-1
00:31:04.669 --> 00:31:06.040
to connect to Azure.

f4434792-0b18-43fb-8fb3-4e24a05611e5-0
00:31:06.600 --> 00:31:07.680
So if I run it.

a53f3040-492c-4e57-b83b-9174b2667cd0-0
00:31:08.520 --> 00:31:12.280
So now the function app will start
locally.

252d3d43-d00d-456a-9db5-5db739e04bc6-0
00:31:12.600 --> 00:31:13.560
So you can debug.

1b295adf-7323-47da-a170-92d243be15d8-0
00:31:21.570 --> 00:31:30.793
So what I'll do is I'll go to here,
I'll stop the this function app because

1b295adf-7323-47da-a170-92d243be15d8-1
00:31:30.793 --> 00:31:34.920
if I test it, I'd stopped already.

cdd68c11-69a1-4b40-a684-fce46d9950e4-0
00:31:35.640 --> 00:31:36.320
Yeah, cool.

2db5c318-eb44-4a53-94f8-963b1b7d2f37-0
00:31:39.200 --> 00:31:41.960
And now what?

0995511f-af4c-4869-9c05-bee2fd67f9e2-0
00:31:50.370 --> 00:31:59.330
The other thing I think lately ask what
changed the proxy.

afabc842-4ef9-4405-8694-90c281d88b11-0
00:31:59.770 --> 00:32:05.683
So this could be problem for you guys is
something I think they've changed the

afabc842-4ef9-4405-8694-90c281d88b11-1
00:32:05.683 --> 00:32:07.480
proxy to something else.

4074ea7f-19ce-4b20-833c-c2075dc17b72-0
00:32:07.480 --> 00:32:14.400
I mean, that could be that proxy.

f7cad9b0-70fd-4557-9081-9c6791beebd1-0
00:32:14.400 --> 00:32:25.920
I think there was an email sent proxy
configuration.

be81319b-c499-4507-ba25-562f75a8dd53-0
00:32:26.480 --> 00:32:29.120
I don't know why they did that.

6e64b4de-07d5-4711-bfcb-5b63e96d2ee1-0
00:32:29.920 --> 00:32:32.240
This this is referenced in so many places.

b8618ffc-e5c8-4ab9-b1ae-2e2e44d3518f-0
00:32:32.240 --> 00:32:41.360
So so if you see error with SSL or
anything proxy it's issue with proxy.

45a4bb16-2ccd-4d71-84de-32cb393e2f7b-0
00:32:41.360 --> 00:32:44.920
So let me change it back.

7b7d5780-93a4-449b-bcde-843453603208-0
00:32:48.040 --> 00:32:50.480
Hope is the proxy is doing it.

1ece8ca9-f342-4648-b5a1-5b7e2351bf8b-0
00:32:54.000 --> 00:32:55.600
They should have had a redirect.

b1134584-3770-47ca-8330-a6cb22ee13e2-0
00:33:05.280 --> 00:33:07.080
Which Visual Studio version you're using?

6aef4e13-2c3f-46b4-b231-1bd843eae853-0
00:33:07.840 --> 00:33:13.360
The 20, It's I think 2020.

17d45b59-9922-463b-b115-47ded422a038-0
00:33:13.680 --> 00:33:16.200
Let me check.

47d6cec4-f30d-484a-ace6-303e88876189-0
00:33:17.440 --> 00:33:28.240
Yeah, 2022.

c4c02ee3-c417-4f86-8a08-19b146d858be-0
00:33:29.360 --> 00:33:29.680
OK.

39a196d7-a3c5-4256-ae58-d9ca41340b46-0
00:33:30.000 --> 00:33:30.880
Enterprise version.

3e42cfc5-d1c2-4934-82fa-d9edc997598b-0
00:33:31.360 --> 00:33:31.760
Yeah.

ba82914d-bef8-4af2-9b28-6c164accdfbf-0
00:33:34.760 --> 00:33:35.200
What is it?

6a82cba7-0400-44e1-9f3d-2b07f82d9327-0
00:33:35.200 --> 00:33:37.520
SAN, evidence connection.

a5d912f7-b2a8-4816-b1b7-e8bbf1906599-0
00:33:42.760 --> 00:33:43.920
It's a token service.

242b452a-69f4-4c2c-b3d6-b8b5d14988ed-0
00:33:46.120 --> 00:33:47.320
Yeah, I need to have a look.

7b3c596b-f17b-4493-a3b7-fcdf317e76ed-0
00:33:48.640 --> 00:33:48.800
Yeah.

23aabb15-48c2-4abd-9daf-416648d08b80-0
00:33:49.440 --> 00:33:51.760
I think this is this is a proxy issue.

7e17bc09-05af-4562-bcef-4985c35a5265-0
00:33:51.760 --> 00:33:59.588
For some reason it's can't establish a
connection because of it's blocking SSLS

7e17bc09-05af-4562-bcef-4985c35a5265-1
00:33:59.588 --> 00:34:03.600
handshake is blocked by proxy, I believe.

e21d9167-9104-4a8d-9c03-1138bb582c95-0
00:34:06.000 --> 00:34:11.400
But anyway,
So what you can do is you can run the run

e21d9167-9104-4a8d-9c03-1138bb582c95-1
00:34:11.400 --> 00:34:15.800
your function app locally for your
testing.

81a78ff7-3a0b-4863-b642-38d0d0307dac-0
00:34:15.800 --> 00:34:21.720
So you can get a copy this sample payload
in into the chat.

9f3d7665-73bd-442b-ab53-26894b0532fc-0
00:34:21.720 --> 00:34:21.840
Yep.

aa3b3834-69e9-46c7-92c4-e1b52c0593d0-0
00:34:33.960 --> 00:34:38.960
So there's a tool called Storage Explorer.

8f772240-1ed5-4379-af5e-0b6dea515f95-0
00:34:40.080 --> 00:34:42.240
I think you guys probably using it
already, right?

eb12cf14-e7c9-4bd3-bd9c-04c810787de8-0
00:34:42.240 --> 00:34:43.560
Yes, we are using it.

88a4f8dd-2e4a-4606-8b9d-845941fb94e7-0
00:34:43.560 --> 00:34:46.080
Yeah, Storage Explorer.

56e2058f-3ae1-417b-9c5a-51d8f8387f06-0
00:35:08.400 --> 00:35:12.520
So you can see queues and you go to file
queue.

3d218ae3-d223-43e4-925c-772c5dba7e1d-0
00:35:16.280 --> 00:35:22.960
It should be a lot of messages in there,
so I'll maybe delete them.

8acf03be-7cb9-4e19-bf56-336bb5f84f03-0
00:35:24.880 --> 00:35:27.520
This is the payload for that request,
yeah.

ff766a2e-60f3-4a76-803b-1d865e3e8e7f-0
00:35:29.360 --> 00:35:35.040
So you can add 1,
you can add and put the payload in there.

7fb64d57-4bdc-461f-834f-8f06334db497-0
00:35:35.400 --> 00:35:40.640
So these these sort of simulating the
logic app, right?

a47daedc-ea48-4648-b5dc-bf0a962faeed-0
00:35:40.640 --> 00:35:43.560
So Logic app instead of logic app
publishing.

5433fd26-8b5a-4140-8813-745778923bef-0
00:35:43.560 --> 00:35:47.960
So you you can get get it done from the
record as well.

d4cfa6d7-adaa-41e8-a7fc-6e4d4faa2402-0
00:35:47.960 --> 00:35:53.107
But if you want to quickly debug,
you just publish a message here and then

d4cfa6d7-adaa-41e8-a7fc-6e4d4faa2402-1
00:35:53.107 --> 00:35:54.000
function app.

379a4d73-9064-4c19-b05e-4af5d4059156-0
00:35:54.080 --> 00:35:58.978
If the function app is running,
you should get it should get it should

379a4d73-9064-4c19-b05e-4af5d4059156-1
00:35:58.978 --> 00:36:04.360
get running should this should get
triggered and you should be able to debug.

0499cb1d-6c35-4c81-8372-6d986657f3fc-0
00:36:07.520 --> 00:36:11.000
So the function of trigger point is like
queue added or something.

58d81bb7-0856-4e07-9c8b-f36422640ccb-0
00:36:11.520 --> 00:36:15.280
Yeah, queue message,
it listens for that to this queue, right.

9410a356-5d7a-4082-92d4-cfdd6fa5fbbe-0
00:36:15.280 --> 00:36:18.414
So this queue anytime it get a new
message added,

9410a356-5d7a-4082-92d4-cfdd6fa5fbbe-1
00:36:18.414 --> 00:36:21.360
then it will a new trigger will get
triggered.

32a4660f-7947-46cb-9b1a-b1a7cae63c26-0
00:36:21.760 --> 00:36:25.332
So if we add here,
the function of local run will trigger

32a4660f-7947-46cb-9b1a-b1a7cae63c26-1
00:36:25.332 --> 00:36:25.640
also.

c53568c2-8d39-4207-b0f4-21bac109e0c4-0
00:36:25.920 --> 00:36:26.640
Yeah, yeah.

674d411c-e6e4-4512-89cd-ff790330e1f7-0
00:36:26.640 --> 00:36:29.680
But I can't run it because of the SSL
issue.

dee947db-2b6e-484a-947c-f015cd9fdcd9-0
00:36:30.200 --> 00:36:36.240
Otherwise I could have showed you it's
running.

866e7e34-d188-4e0d-b8cb-4de987cce142-0
00:36:37.880 --> 00:36:41.223
But yeah,
so otherwise the starting point is the

866e7e34-d188-4e0d-b8cb-4de987cce142-1
00:36:41.223 --> 00:36:42.520
file copy function.

08d1ce85-1a5e-4084-bada-e4cb1ef481b9-0
00:36:42.520 --> 00:36:49.817
So if you put a break point here,
so you will see the Jason is in here and

08d1ce85-1a5e-4084-bada-e4cb1ef481b9-1
00:36:49.817 --> 00:36:53.320
then it will start copying the file.

837c7342-21a8-4210-9aa9-2ec298847c95-0
00:36:53.320 --> 00:37:04.905
OK,
so this also is the source code is in is

837c7342-21a8-4210-9aa9-2ec298847c95-1
00:37:04.905 --> 00:37:07.480
in GitHub.

e19ebf12-773c-4ee3-819b-a0290c200db5-0
00:37:07.720 --> 00:37:15.400
I said not GitHub Azure OPS git and this
deployment is automated.

d1f6a915-ac21-4b5a-ba72-d729d6bc3ff6-0
00:37:16.120 --> 00:37:18.440
This deployment is automated only for dev.

ba9b8a1f-2558-4604-a5c2-82ba9de4b67e-0
00:37:18.440 --> 00:37:22.000
So, so we haven't done it after.

b94e8907-2746-4c19-9e47-28b9444a1ce4-0
00:37:22.640 --> 00:37:30.600
So when you guys deploying it like do the
logic app first.

fefd0cf6-982e-4392-96e1-cc00b2e5ec4d-0
00:37:30.880 --> 00:37:34.586
Once the logic app is everything's done,
everything tested in dev,

fefd0cf6-982e-4392-96e1-cc00b2e5ec4d-1
00:37:34.586 --> 00:37:36.080
then you can promote it to.

b6f71ded-8543-4c09-b8de-2eb7ff4fb68b-0
00:37:38.800 --> 00:37:44.960
So there's,
there's integration files pipeline.

d2561e0a-1bfd-486a-b361-79a0209d9268-0
00:37:44.960 --> 00:37:48.600
So you can see pipeline only goes up to
dev.

c254d8b3-b2e0-4657-a6d9-8a6d4969e402-0
00:37:48.920 --> 00:37:51.531
So you, you,
you guys need to add the rest of the

c254d8b3-b2e0-4657-a6d9-8a6d4969e402-1
00:37:51.531 --> 00:37:52.680
environments in there.

ec610ca8-1139-4674-99b8-4395daef9bc5-0
00:37:54.480 --> 00:37:54.720
OK.

f996de9d-7542-408c-af79-903e98e7386e-0
00:37:54.800 --> 00:37:56.440
How about the queue names?

700b51bc-a279-4675-a4e3-de88fef8705b-0
00:37:56.440 --> 00:37:58.160
The queue, it's in dev, right?

608e5324-3490-4b9a-9331-82df5d466b15-0
00:37:58.280 --> 00:38:01.520
That Q is in dev Yeah, yeah.

af40c3c7-31f3-4dfa-a443-26fee710a6c3-0
00:38:01.520 --> 00:38:03.280
So that all the infrastructure.

d0447b6a-8fdf-4444-a4a3-701d70fa87c2-0
00:38:03.480 --> 00:38:07.600
So the only infrastructure chain in my
understanding.

642e9e7b-108e-4474-8681-4a0b5868c6aa-0
00:38:09.720 --> 00:38:17.828
So,
So what I've done is so this logic app,

642e9e7b-108e-4474-8681-4a0b5868c6aa-1
00:38:17.828 --> 00:38:25.200
this logic app so logic app also have a.

497f36e1-b897-4832-a47f-c6adaf25966f-0
00:38:28.240 --> 00:38:30.480
So this logic app,
let's see this logic app.

60f3f6d4-96b9-473b-b185-5c0e70c531b8-0
00:38:30.920 --> 00:38:33.360
Logic app has identity.

5f079c36-af33-484a-aa31-85862977613c-0
00:38:34.840 --> 00:38:42.002
If you go to settings,
has identity enabled so that this logic

5f079c36-af33-484a-aa31-85862977613c-1
00:38:42.002 --> 00:38:50.301
app should have this identity of the
logic app should have access to the

5f079c36-af33-484a-aa31-85862977613c-2
00:38:50.301 --> 00:38:52.120
storage account.

e527520d-2836-4538-abf0-e4c5f92e3ab3-0
00:39:05.040 --> 00:39:07.520
Storage account, Was it the six?

2c851d72-801d-4e86-a04e-6968f43deb1d-0
00:39:10.120 --> 00:39:20.960
This one is 1, I think the last one.

799e2679-5ab6-4fab-a088-ebee673ceda6-0
00:39:21.560 --> 00:39:25.000
Let me go there.

f95fe966-3509-4426-bac6-5f65bff765bb-0
00:39:30.080 --> 00:39:36.780
See,
there's a one this this one is probably

f95fe966-3509-4426-bac6-5f65bff765bb-1
00:39:36.780 --> 00:39:40.800
the one the storage queues.

02cbe606-a0ae-4d37-adad-e9829f9c6147-0
00:39:42.440 --> 00:39:45.318
Yeah,
file capability is the storage that has

02cbe606-a0ae-4d37-adad-e9829f9c6147-1
00:39:45.318 --> 00:39:46.320
the queue in it.

aa741d11-7c5c-4d01-bf04-7ff5dca21def-0
00:39:47.160 --> 00:39:52.192
And so this queue this how this queue
link to the function of do we if we are

aa741d11-7c5c-4d01-bf04-7ff5dca21def-1
00:39:52.192 --> 00:39:55.160
deploying the queue to different
environment?

61f003c0-f423-45fb-8aed-8aec3f756537-0
00:39:55.720 --> 00:39:57.400
Yeah, it will so be the same.

0aa87396-4e03-451b-bfed-7685a4bd5f07-0
00:39:57.400 --> 00:39:57.560
Good.

ddfc4bff-19c2-48d5-96c3-8cf29e249625-0
00:39:58.280 --> 00:39:59.160
Yeah, yeah.

37d47e55-2144-419f-a8aa-5c42596c06d4-0
00:39:59.160 --> 00:39:59.480
So.

88106b15-0ba9-4cf3-9f4b-a9b93b309aff-0
00:39:59.480 --> 00:40:01.960
So each environment should have its own.

2a822253-5435-455b-97fa-68d1a7f29c7b-0
00:40:02.760 --> 00:40:08.311
Storage account yes,
like for test would have its TE storage

2a822253-5435-455b-97fa-68d1a7f29c7b-1
00:40:08.311 --> 00:40:09.040
account.

d68dda59-4090-4314-88de-6ca129ea0a4a-0
00:40:09.520 --> 00:40:12.120
So you need to go and add a queue.

1f0ad5f2-696f-43be-b4ee-d984cfafbd5a-0
00:40:12.760 --> 00:40:14.040
So that's something you can do.

01bbb813-b4bb-4bcc-832c-5866d6d48709-0
00:40:14.040 --> 00:40:19.171
You will have so it's a manual creating a
queue or yeah queue is export the queue

01bbb813-b4bb-4bcc-832c-5866d6d48709-1
00:40:19.171 --> 00:40:23.364
also because it's a one time yeah and
then GUID will be different,

01bbb813-b4bb-4bcc-832c-5866d6d48709-2
00:40:23.364 --> 00:40:25.680
right There's no GUID, so it's a URL.

7f519266-14d6-4f96-b26e-41f7a7c358d1-0
00:40:26.240 --> 00:40:28.880
OK, so URL will be different.

ca3e9575-1e9e-4e51-b213-1a243338b846-0
00:40:29.040 --> 00:40:35.360
The URL is again coming from the Where
did where does it come from?

5039295f-e3b4-48d2-baea-f6dfab204100-0
00:40:35.400 --> 00:40:47.520
The QURL it's starting coming from the
key keyword no?

8ebcc64f-93ce-4008-95ff-7affcf778e94-0
00:40:49.320 --> 00:41:02.550
So there probably the Logic apps linked
to the queue you're configuring there.

f9ca242f-3f62-4d4e-93ec-d8e619a256c2-0
00:41:04.270 --> 00:41:07.360
So, so logic app settings are different,
right?

476bbadd-45ac-4f44-9548-58d9faaa5866-0
00:41:07.600 --> 00:41:10.320
So the function app,
the way function app reads.

3a14fff1-165d-48b2-94e4-65f99c0c4de7-0
00:41:11.080 --> 00:41:15.145
Let's go back to function app, OK,
so you can see function app is already

3a14fff1-165d-48b2-94e4-65f99c0c4de7-1
00:41:15.145 --> 00:41:15.640
deployed.

2772ff1e-44b9-44cd-82d0-c62e0de7951c-0
00:41:15.640 --> 00:41:21.480
I'll I'll start this settings.

98b789ad-88e6-4089-8ef6-314cfe43c185-0
00:41:21.480 --> 00:41:38.720
So if you go to settings, so you will see.

0bb15f72-f8ed-4c46-a0db-3dbcd6c198a1-0
00:41:38.760 --> 00:41:44.240
So this is so this is the QURN OK, right.

992991bf-11a5-4117-8f17-8207bd3a08a1-0
00:41:44.240 --> 00:41:50.960
So this is the this is where it it it so
you can see the queue URL.

bc617a87-9381-48b9-a6d4-01ea5d88fb3c-0
00:41:50.960 --> 00:41:56.039
So so Logic app,
that's how Logic app get linked to the

bc617a87-9381-48b9-a6d4-01ea5d88fb3c-1
00:41:56.039 --> 00:41:57.400
queue function.

b89d0112-a9e2-4f11-84e3-d8c0b4b3a6ac-0
00:41:58.560 --> 00:42:07.560
So it uses that URL plus this queue name,
right.

69e6f1fa-1a28-495f-a3e0-310eecae7945-0
00:42:07.560 --> 00:42:15.913
So if you go back to the,
if you go back to the storage, the QURL,

69e6f1fa-1a28-495f-a3e0-310eecae7945-1
00:42:15.913 --> 00:42:19.280
so you see a QURL in there.

179e2a77-4bfa-427c-b55b-63f7dc05f114-0
00:42:19.600 --> 00:42:21.720
So you can see that that's a QURL, right?

ec62e971-1ff3-403b-8a4b-bd42ba6a834d-0
00:42:22.320 --> 00:42:30.720
That that initial URL plus the QA is the
one that it needs to.

d9c5e183-f49e-48d3-8b72-6bbcf16f2c2b-0
00:42:32.920 --> 00:42:34.360
So it doesn't use any.

bbae4f59-58c1-404b-842a-3adfcde5cd55-0
00:42:34.640 --> 00:42:39.120
So you guys using account keys to
authenticate to BLOB storage, right?

44bed748-8f25-48db-83b2-8767f6dc1ebc-0
00:42:39.600 --> 00:42:41.440
So that's a less secure way to do it.

93c10776-0802-4b62-a43f-e4d2ae0239a4-0
00:42:41.880 --> 00:42:47.920
So the the most secure way to do it is
don't use keys because keys expire, right?

35f18123-63b7-42e7-9a9a-bb02ccaf86bc-0
00:42:47.920 --> 00:42:54.280
You have rotate and if you lose the key,
then your security is compromised, right.

42f8374a-88f9-4999-ac5b-e72dde96edb1-0
00:42:54.640 --> 00:42:57.480
So there's a concept called manage
service identities.

6306f3c9-6b9e-46fb-9b3f-cb96a6d8fe1d-0
00:42:57.600 --> 00:43:00.621
So you have,
so each Azure service has its own

6306f3c9-6b9e-46fb-9b3f-cb96a6d8fe1d-1
00:43:00.621 --> 00:43:01.200
identity.

87ee18c0-f4b0-49e5-9a06-912cd870dce4-0
00:43:01.920 --> 00:43:06.304
So when you talk to another,
another Azure service,

87ee18c0-f4b0-49e5-9a06-912cd870dce4-1
00:43:06.304 --> 00:43:13.388
you can get a access token to access the,
the destination service we see using your

87ee18c0-f4b0-49e5-9a06-912cd870dce4-2
00:43:13.388 --> 00:43:17.520
identity so that that that token is short
lived.

26d20107-5ebc-4a3e-a2d3-9d64afb12905-0
00:43:18.000 --> 00:43:19.760
So, so we don't use any keys.

00d8a57c-8a02-466d-a4ed-7d33d18a8599-0
00:43:19.760 --> 00:43:25.240
We just so this is the resource and
that's what I was going to show you.

9898b293-028b-4990-8985-da84ad830e3d-0
00:43:27.960 --> 00:43:35.880
So if you go to the access roles,
maybe you know for assignments.

9c666179-27fd-4fa2-a072-9372753b5c09-0
00:43:40.200 --> 00:43:58.430
So it could be maybe queue access,
so each queue have its own access.

9aeaf191-91d2-4753-942c-c9b6c0d6615f-0
00:44:47.620 --> 00:44:55.491
So you can see so that Logic app right
that Logic App have access as a queue

9aeaf191-91d2-4753-942c-c9b6c0d6615f-1
00:44:55.491 --> 00:44:59.580
data contributor who can read and write.

03b9ffea-0713-4906-8c38-29691acf92fd-0
00:44:59.980 --> 00:45:03.180
So that means Logic app given access to
the queue.

0e5e3be1-eb02-4787-a19a-815561d077af-0
00:45:04.300 --> 00:45:09.347
So if you search for function app,
so function app should have a similar

0e5e3be1-eb02-4787-a19a-815561d077af-1
00:45:09.347 --> 00:45:10.800
role in here as well.

5d3a7388-8239-48ad-a33a-d69fcb385876-0
00:45:11.120 --> 00:45:13.916
So,
so you have a queue in the middle one's

5d3a7388-8239-48ad-a33a-d69fcb385876-1
00:45:13.916 --> 00:45:17.920
writing, logic app is writing,
function app is reading, right.

0c1a5ab5-f888-4bc7-8b72-05fc21b65a04-0
00:45:18.360 --> 00:45:21.800
So both they don't use any account keys.

66c84d3b-4059-429b-a4f4-63dac324543b-0
00:45:22.480 --> 00:45:25.680
They use their own identities to read and
write.

2b93a6eb-1bb1-4b5b-864e-fc6e8d96f516-0
00:45:27.120 --> 00:45:32.520
OK, so,
so the queue will be assigned to the

2b93a6eb-1bb1-4b5b-864e-fc6e8d96f516-1
00:45:32.520 --> 00:45:33.720
Logic App.

ec574af1-603a-4ac7-aaa9-bb63685a3039-0
00:45:33.880 --> 00:45:37.280
I mean, the storage account,
the queue will be there.

965a1fc7-9af4-4902-8d45-e653b1b64284-0
00:45:37.400 --> 00:45:39.880
The queue will have that URL, Yeah.

2ad037f1-4e68-425b-8c8c-fc7d92d27ca3-0
00:45:39.880 --> 00:45:43.480
And the function app will read the queue
name and then that URL.

3add91a5-e0ae-4469-b90e-d59b79287b60-0
00:45:44.440 --> 00:45:47.400
Yeah, executed, yeah, Logic App,
that's the same, right?

5a4bbdf5-695a-47d8-8a41-780e423690f7-0
00:45:47.960 --> 00:45:54.440
Logic App use the URL and the queue name
and use its own identity to talk.

52af8bb4-b7fa-4fa7-bfd4-05f83edcbcba-0
00:45:56.240 --> 00:45:56.480
Yeah.

a97109b5-03bb-48a2-8499-0d3942fbcd46-0
00:45:56.800 --> 00:46:02.179
So, so when you promote to test,
so you need to create this file copy

a97109b5-03bb-48a2-8499-0d3942fbcd46-1
00:46:02.179 --> 00:46:03.640
queue, yeah, right.

55c27d1b-6eeb-452e-8091-e6dd2fc4fe29-0
00:46:04.360 --> 00:46:10.280
And then get you can't assign roles,
you don't have permissions.

95dda420-5e16-463a-8f5f-52e0fffd05be-0
00:46:10.280 --> 00:46:13.400
You could you have permissions to create
the queue, Yes, right.

27690e93-903b-427b-9198-291da9deeb0c-0
00:46:13.880 --> 00:46:19.417
So after creating the queue,
you need to raise a support ticket with

27690e93-903b-427b-9198-291da9deeb0c-1
00:46:19.417 --> 00:46:25.435
the Azure team to assign these roles to
to the particular queue particular

27690e93-903b-427b-9198-291da9deeb0c-2
00:46:25.435 --> 00:46:26.879
identities, right?

e239c769-d6a8-4683-9f8e-33f5f8e72582-0
00:46:26.880 --> 00:46:33.677
So assign the data contributor roll to
the manage, manage system,

e239c769-d6a8-4683-9f8e-33f5f8e72582-1
00:46:33.677 --> 00:46:42.225
manage service identity of the logic app
and also assign the same role to the role

e239c769-d6a8-4683-9f8e-33f5f8e72582-2
00:46:42.225 --> 00:46:44.800
to the function function.

b6ba3450-5964-4cc5-ab50-cdbde08050ff-0
00:46:44.800 --> 00:46:44.920
Yep.

7756c8e4-1e1b-4851-8ea1-2904bdde810b-0
00:46:47.200 --> 00:46:49.880
So couple of things to do so.

69d350c1-cedb-4be6-8c93-bfb1534af556-0
00:46:50.200 --> 00:46:53.585
So when we are moving the code from there
to test,

69d350c1-cedb-4be6-8c93-bfb1534af556-1
00:46:53.585 --> 00:46:58.763
so the queue needs to be created there
and the code there is no change in the

69d350c1-cedb-4be6-8c93-bfb1534af556-2
00:46:58.763 --> 00:46:59.559
code, right?

51b71eb1-ad3a-4d3f-968d-5f7d86fbc753-0
00:46:59.560 --> 00:47:02.398
Because you're,
if I'm creating AQ name as file copy in

51b71eb1-ad3a-4d3f-968d-5f7d86fbc753-1
00:47:02.398 --> 00:47:04.781
test, yeah,
I don't need to change anything in

51b71eb1-ad3a-4d3f-968d-5f7d86fbc753-2
00:47:04.781 --> 00:47:05.440
function app.

6da2bdb3-82d2-4824-a859-15e6082e5492-0
00:47:05.480 --> 00:47:08.040
It's just code deployment there,
that's all.

9ed88596-189b-4822-a2dc-b1429e90bbc4-0
00:47:08.160 --> 00:47:09.440
So settings are here, right?

aa4d4880-7e33-46f8-8a4b-fe0c7ef51d23-0
00:47:09.440 --> 00:47:14.132
So if you could for example, test,
so you can see there's there are no test

aa4d4880-7e33-46f8-8a4b-fe0c7ef51d23-1
00:47:14.132 --> 00:47:15.120
settings, right?

43a5c24e-12db-4277-8fd5-c8c0017fb1dc-0
00:47:15.760 --> 00:47:20.000
So you need to configure these settings
into the test.

804dc59a-0c79-433d-8da4-cda8d6c79493-0
00:47:20.600 --> 00:47:23.160
These settings will be different, right?

33a5ab27-73b8-4133-8575-5edb377c639b-0
00:47:25.000 --> 00:47:32.478
For example BLOB URL will be different
but the proxy settings will be the same

33a5ab27-73b8-4133-8575-5edb377c639b-1
00:47:32.478 --> 00:47:33.520
SharePoint.

2ce21993-f448-4cb1-9182-0994b4de5f69-0
00:47:34.440 --> 00:47:37.000
I believe this this is non prod one.

24adacbd-4774-4d66-9a40-b1de6c5adba9-0
00:47:37.000 --> 00:47:40.120
Probably we need the prod one too for
test.

e4adeced-65f7-4cf2-8d02-477418af8c93-0
00:47:41.120 --> 00:47:43.400
No not test the production one I'm
thinking.

fa4ea1ed-5598-4ad2-aaec-86f914818a81-0
00:47:43.440 --> 00:47:44.600
So test will be same.

5cd8d7f7-8a75-43ea-9454-4f998cd15ba0-0
00:47:44.600 --> 00:47:46.640
Test, pre, prod and dev all are same.

a05d288e-1033-43bf-8919-27430278aab7-0
00:47:47.160 --> 00:47:49.773
Yeah,
we can copy the same thing I think for

a05d288e-1033-43bf-8919-27430278aab7-1
00:47:49.773 --> 00:47:53.141
SharePoint, yes,
SharePoint you're using same for all the

a05d288e-1033-43bf-8919-27430278aab7-2
00:47:53.141 --> 00:47:55.000
but for BLOB will change, right?

f3c9643e-4da2-46f6-84f1-3bfe5a075c7a-0
00:47:55.000 --> 00:47:56.160
So BLOB will change.

29e30705-57fc-4012-a43b-8916025c53cd-0
00:47:56.280 --> 00:48:00.200
So the only code change you will require
is the settings changes.

9b2202b9-e4c8-4e30-a52f-57656505e237-0
00:48:00.400 --> 00:48:08.382
So whatever settings that you can just
copy paste into dev and not change the

9b2202b9-e4c8-4e30-a52f-57656505e237-1
00:48:08.382 --> 00:48:11.760
SharePoint, change the BLOB then.

088b792d-1c74-483b-899e-5d36cca830f4-0
00:48:11.920 --> 00:48:15.593
So when we move to the test environment,
how the system know we should it should

088b792d-1c74-483b-899e-5d36cca830f4-1
00:48:15.593 --> 00:48:17.000
read from the app setting test.

3c5c8fe1-528a-4c63-ad7b-f7c38922f259-0
00:48:17.000 --> 00:48:18.600
It's out of the box.

d9198dab-1229-4f7f-9aef-ad6babc6576b-0
00:48:18.920 --> 00:48:19.200
It's out.

cf7828ee-dc3e-41c0-a9fd-f40728c98485-0
00:48:19.200 --> 00:48:19.600
Do we need to?

30c965d3-d91e-4f8f-b04f-9f5b267f41ba-0
00:48:20.080 --> 00:48:20.760
OK, it's out of the box.

4085579a-b977-4339-b17d-c8898cbfc796-0
00:48:20.800 --> 00:48:22.680
But this is the unique name.

92e46a75-935f-4354-9b24-515657263047-0
00:48:22.680 --> 00:48:23.920
We should follow it.

51ebdf0a-c6a5-425d-bf98-ce0bd64d1a3f-0
00:48:23.920 --> 00:48:24.280
Is it?

e29e35a5-2ad4-4646-8169-d0ca9d0e03c2-0
00:48:24.600 --> 00:48:24.920
Yeah.

662e3632-77d3-462d-bf2c-d8029bf46661-0
00:48:25.000 --> 00:48:25.240
Yeah.

e59d1049-aadb-44af-9bc7-68a875e09ddb-0
00:48:25.360 --> 00:48:28.520
So, so, so think of your logic.

22dc1cd7-9d16-4aff-bb7b-3f871f8de92a-0
00:48:28.760 --> 00:48:30.960
He's agnostic of your configuration,
right?

a6d3a836-de7c-4d39-aa2f-c86edf538a8a-0
00:48:30.960 --> 00:48:32.440
So logic remains the same.

4bd4caff-440b-4e5f-bc79-b1aad45a540b-0
00:48:32.800 --> 00:48:37.053
So you change the configuration,
you give the configuration and you need

4bd4caff-440b-4e5f-bc79-b1aad45a540b-1
00:48:37.053 --> 00:48:38.160
to allow it, right?

4845f0c5-1edf-4cc1-ae19-ab4702ed1e86-0
00:48:38.160 --> 00:48:40.040
So that's where the access part will come
in.

1fa5dc3c-fece-4e6a-b39d-35e998d8ffd1-0
00:48:40.880 --> 00:48:44.440
So once that is set up,
you don't have to change any code.

074d62a9-ba80-4990-8683-bab489a5eb07-0
00:48:44.560 --> 00:48:47.666
You'll just, yeah,
the copying logic is the same in each

074d62a9-ba80-4990-8683-bab489a5eb07-1
00:48:47.666 --> 00:48:48.320
environment.

c5f1bd40-0cc9-4da8-88a6-e02f8568511e-0
00:48:49.360 --> 00:48:53.360
But what if there is a new environment we
are setting up and we are using Vinuka.

aa2e79e2-e77f-4387-920e-24cf04d549a5-0
00:48:53.480 --> 00:48:56.860
So this one is like for the existing
environment, we have this, right,

aa2e79e2-e77f-4387-920e-24cf04d549a5-1
00:48:56.860 --> 00:48:57.480
It will read.

fe8ada56-a826-4b65-9fe3-2cfba19888a6-0
00:48:57.480 --> 00:49:01.138
But what if there is a new environment
that we're spinning off tomorrow and we

fe8ada56-a826-4b65-9fe3-2cfba19888a6-1
00:49:01.138 --> 00:49:02.760
need to add that here How we do it?

b41de6ce-011f-4fc4-bc13-2a704bfcf163-0
00:49:02.760 --> 00:49:04.200
Yeah, it's, it's the same thing, right?

86482567-b351-45d5-8924-ab625ee8a42e-0
00:49:04.200 --> 00:49:07.520
So in new environment,
you will have a function app, right?

3e22f421-d918-4528-b4ba-fd002f749e31-0
00:49:07.520 --> 00:49:11.939
So every so in in Azure team,
when they provision a new environment,

3e22f421-d918-4528-b4ba-fd002f749e31-1
00:49:11.939 --> 00:49:17.255
they have a set of resources that they're
gonna generate creating to that resource

3e22f421-d918-4528-b4ba-fd002f749e31-2
00:49:17.255 --> 00:49:17.640
group.

fa3ac667-e32b-4808-b426-392b1add2dd1-0
00:49:18.160 --> 00:49:19.680
So that will have a function app.

de9a827c-44a5-4e5e-add5-4146d621af9e-0
00:49:20.160 --> 00:49:25.240
So So what you need to do then is
configure your pipeline, right?

6046604a-54cf-4e0b-8449-6bf3aac0b449-0
00:49:25.240 --> 00:49:27.240
So you need to add a new environment here.

8f48a794-0921-414f-9f47-eb86ca0d6299-0
00:49:27.800 --> 00:49:31.120
All right, So environment there.

e8edc52e-f9bd-4222-b71e-b2fbd3503898-0
00:49:31.120 --> 00:49:34.760
And then maybe let me check task library.

edce1fe3-22c4-437e-881d-ec001270c064-0
00:49:38.000 --> 00:49:40.080
No, this doesn't have any settings there.

01d2c331-2a5f-4004-aef1-6346e789377c-0
00:49:40.080 --> 00:49:42.480
So just create a new environment.

a1ec1264-feaf-46cf-a648-1cb6304c2f1f-0
00:49:43.240 --> 00:49:48.745
And in your pipeline,
you need to add a new environment to it

a1ec1264-feaf-46cf-a648-1cb6304c2f1f-1
00:49:48.745 --> 00:49:51.320
and it'll just deploy, right?

0e679beb-d59b-4726-a0b9-6d02818c185a-0
00:49:51.320 --> 00:49:53.560
So, so the environment setting.

e85412ed-306f-41f4-91e4-27ea51558d14-0
00:49:53.560 --> 00:49:55.280
Oh, sorry.

a5b85d8e-381a-4e04-9634-0953ddd701d3-0
00:49:55.280 --> 00:49:56.200
So three things, right?

1b62ffab-6c02-422a-8a50-1f8b8db74ee6-0
00:49:56.200 --> 00:49:58.040
So create environment in here.

7f1360cd-c188-4681-bfdd-62e1c60790c0-0
00:49:58.560 --> 00:50:02.693
Yeah,
add another stage to your new environment,

7f1360cd-c188-4681-bfdd-62e1c60790c0-1
00:50:02.693 --> 00:50:03.200
right?

326d1656-8407-4245-8917-2bfb8bbf11b9-0
00:50:03.560 --> 00:50:10.109
And change the settings in in in here
we'll be adding a new setting, right,

326d1656-8407-4245-8917-2bfb8bbf11b9-1
00:50:10.109 --> 00:50:16.400
App setting dot something so that if it
is a new environment, yes, yeah.

e7aed8f8-b46e-40a1-b48e-fde8ffbd2976-0
00:50:16.760 --> 00:50:21.994
So how will the function app know to go
and check in this one like this app

e7aed8f8-b46e-40a1-b48e-fde8ffbd2976-1
00:50:21.994 --> 00:50:25.920
setting is for this environment,
it's default behaviour.

6aadf115-eba9-4a05-8bb7-79d5d115b422-0
00:50:25.920 --> 00:50:31.933
So if you look at so there's there's a
the the the where everything starts is

6aadf115-eba9-4a05-8bb7-79d5d115b422-1
00:50:31.933 --> 00:50:34.400
from the programme files, right?

1a1d1399-b270-49fb-8702-08789b3373c0-0
00:50:35.120 --> 00:50:36.200
Programme files.

c65cb57b-9dc2-406a-b55e-c601fe2697cc-0
00:50:36.200 --> 00:50:41.720
You can see first it reads the app
settings dot Jason, yeah.

12f59c6b-7664-4bad-a823-ec9c30e837f8-0
00:50:42.760 --> 00:50:50.520
And then it in the app settings dot
environment, right?

c0cd00c1-230a-43b5-a598-cfbe675534e4-0
00:50:50.520 --> 00:50:51.720
And then it merges.

3a8dc80d-6020-4fc3-82bf-31a10509dead-0
00:50:52.840 --> 00:50:56.960
So so you can have the base settings in
your app settings, yeah,

3a8dc80d-6020-4fc3-82bf-31a10509dead-1
00:50:56.960 --> 00:51:01.904
and your environment specific settings in
your environment config bar and OK,

3a8dc80d-6020-4fc3-82bf-31a10509dead-2
00:51:01.904 --> 00:51:04.440
for for example, we have dev int, right?

5c5e250c-8a55-44ce-bba5-897d9400ef09-0
00:51:04.600 --> 00:51:07.785
So yeah,
this will going to be do I need to add

5c5e250c-8a55-44ce-bba5-897d9400ef09-1
00:51:07.785 --> 00:51:10.440
app settings to a dev in dot Jason here.

eaed7a84-fea2-4a16-82bc-12797da02993-0
00:51:10.640 --> 00:51:12.960
You need to add dev in Jason.

f694405a-96f4-4281-97cc-66829c635835-0
00:51:12.960 --> 00:51:17.988
And it's because it it will it depends
how you're gonna deploy the Azure

f694405a-96f4-4281-97cc-66829c635835-1
00:51:17.988 --> 00:51:19.160
resources, right.

2a63a882-6965-4e15-a39e-05a32e078506-0
00:51:19.160 --> 00:51:23.040
So I believe Azure resources you're not
gonna share the storage account.

e72b6506-4bab-4632-9390-6cc2bee44103-0
00:51:23.200 --> 00:51:27.000
You probably have a separate storage
account for Devin, right?

5f20666d-adcc-4b20-b5e6-f5cc1094f9e9-0
00:51:27.000 --> 00:51:27.800
Yeah, it's correct.

962d12c9-f384-4663-a016-657845bacdc5-0
00:51:28.200 --> 00:51:31.929
Oh, oh, I don't know,
maybe you decide to share it because you

962d12c9-f384-4663-a016-657845bacdc5-1
00:51:31.929 --> 00:51:34.120
can have different containers, right?

6329cde3-b51d-493a-940c-68330528b277-0
00:51:36.120 --> 00:51:38.960
So it depends on how you decide to do it.

8600f7bb-7ab1-4bc5-8cdb-a2ebcfd480d7-0
00:51:39.440 --> 00:51:39.600
Yep.

bc76050e-b0ca-403a-bfb5-4cc12badf485-0
00:51:39.800 --> 00:51:47.845
So presently we have different storage
like like the BLOB storage or different

bc76050e-b0ca-403a-bfb5-4cc12badf485-1
00:51:47.845 --> 00:51:54.160
different Devin Dev 01 and but no like so
for for dev in dev.

46847996-d960-4dd5-a91e-ca92f7a2aa50-0
00:51:55.320 --> 00:51:59.145
So for example,
if you look at the BLOB containers,

46847996-d960-4dd5-a91e-ca92f7a2aa50-1
00:51:59.145 --> 00:52:03.560
all the dev environments share this
single storage account.

d8edf754-286f-47ed-a5bb-0fa7a4993fa2-0
00:52:03.880 --> 00:52:05.480
OK, this is the block container.

b8f56323-0098-4804-942e-58acaf62d6ed-0
00:52:05.480 --> 00:52:07.640
So different,
but the storage account is same.

24c5c653-275e-4afd-a940-0dd4c9eafbe1-0
00:52:07.760 --> 00:52:09.947
Yep,
storage account is same for all the dev

24c5c653-275e-4afd-a940-0dd4c9eafbe1-1
00:52:09.947 --> 00:52:10.920
environments, right?

e3b5c4c9-332e-471b-b4d1-18a9ccc11247-0
00:52:10.920 --> 00:52:15.000
So you could go with Devin,
could Devin already there, right.

10cc8a1a-7fa9-413c-8ea0-c10f946b1c8c-0
00:52:16.960 --> 00:52:21.720
But the problem here is then so the queue.

908eecda-e9f0-47f8-b31a-ba30bbd41cac-0
00:52:22.400 --> 00:52:23.840
So you need a dev in queue.

67e951d9-f333-4674-a0ed-00b6682f146a-0
00:52:24.880 --> 00:52:26.080
Yeah, right.

7c8c3390-8250-4a91-b72a-fdddd735d007-0
00:52:26.960 --> 00:52:28.640
Then you need to change the logic.

66ec1272-19d2-4d0a-8af5-1102b3cd50f6-0
00:52:28.880 --> 00:52:37.400
So you can't have then sort of the
generic queue name.

9c8c4c09-9745-425e-a573-499dbec500ef-0
00:52:37.600 --> 00:52:46.360
So then it's sort of like have to be some
sort of environment name, then file copy.

d7ba12c7-f7a0-4e58-bc58-049b5eb671fa-0
00:52:46.720 --> 00:52:47.000
Yeah.

24f09623-cbf7-431f-ad10-57436821d749-0
00:52:47.000 --> 00:52:49.240
So that's a, that's a,
that's a code change.

3c3b423a-0690-42e9-9334-418cb0b2f93b-0
00:52:49.560 --> 00:52:53.400
The file copy queue is having a URL,
right?

ed021e9b-95b4-45ce-813b-028cbf115b37-0
00:52:54.000 --> 00:52:54.280
Yeah.

15ad7b08-eae4-450f-a641-64870ad38c48-0
00:52:54.760 --> 00:53:01.600
So even they're getting the Q name can be
same, but the URL can be different, right?

2324dec7-6b9a-443f-9ef3-6ec5e2760ab7-0
00:53:01.800 --> 00:53:04.010
No,
because you're using the same storage

2324dec7-6b9a-443f-9ef3-6ec5e2760ab7-1
00:53:04.010 --> 00:53:04.800
account, right?

8a672f33-07a7-46f8-aee8-8bf02334f50f-0
00:53:04.800 --> 00:53:10.840
So if you go back to the 01 storage,
1 Q name and one URL can't have multiple.

0e18e50a-e324-4818-8c83-d3ef353dc1e0-0
00:53:10.840 --> 00:53:14.320
So it, it, it's,
this is a storage account, right?

0b713891-872d-4411-bc5e-0452a6cce59a-0
00:53:15.200 --> 00:53:17.040
And then the Q&amp;A, right?

3ef5913e-8700-485a-be77-681d3f77c0c6-0
00:53:17.440 --> 00:53:21.520
So what we're saying is we sort of like
starting to partition, right?

bf6b5bdf-732c-4dd1-89a2-499f2d665861-0
00:53:21.520 --> 00:53:27.680
So then, then you can't connect.

fba6a1e4-0ac3-405a-a86b-0b725cc25394-0
00:53:27.680 --> 00:53:31.840
You shouldn't be connecting 2 function
app into a same queue.

6d1b21b8-bd66-4ba1-8933-e1250be94595-0
00:53:33.040 --> 00:53:33.480
Got it.

cc2bc243-d387-4a21-ae4f-5c091084ffa4-0
00:53:34.040 --> 00:53:37.960
So presently we are using only dev 01 for
this.

3abbd597-5951-48ab-bf9b-6fb4bac6430e-0
00:53:37.960 --> 00:53:39.760
Yeah, function app stuff, dev int.

7da813d5-01eb-4edc-a669-bbd8aa81dcd4-0
00:53:39.760 --> 00:53:43.000
We are not configured anything and no,
nothing.

d6e71cb8-c1ba-49ab-85c7-51b95f74269f-0
00:53:43.000 --> 00:53:45.800
Test and pre prod and prod,
they all have only one.

652fb162-d46d-40ef-82bf-4bb7bef042df-0
00:53:45.800 --> 00:53:50.520
They all have yeah, yeah,
only the dev employment is having it.

474c7862-ce22-4172-9fa1-6cf9902e51bd-0
00:53:50.680 --> 00:53:51.480
OK, Yeah.

1033e5a1-4f5a-4b28-9c15-bfbd2e57b940-0
00:53:51.640 --> 00:53:53.000
So you have two options, right?

7c981382-7b92-442d-aeab-09c53d9f088f-0
00:53:53.000 --> 00:54:00.760
One option is to change the code to yeah,
make this queue name environment

7c981382-7b92-442d-aeab-09c53d9f088f-1
00:54:00.760 --> 00:54:02.520
sensitive, right.

ef2e7588-a86d-4d25-9f5e-b9343b6f5ebf-0
00:54:02.960 --> 00:54:03.840
There's one option.

1b6b2c04-816d-480d-ba16-31b72731254b-0
00:54:03.840 --> 00:54:08.190
The second option is have a separate
storage account and have the queue

1b6b2c04-816d-480d-ba16-31b72731254b-1
00:54:08.190 --> 00:54:09.640
separate queue in there.

f0fa93fe-928b-43f4-a6fa-5f5607d53a82-0
00:54:09.640 --> 00:54:09.760
Yeah.

00021b6f-cdc8-47c8-aa78-40219e91de37-0
00:54:10.320 --> 00:54:13.640
So dev enrollment,
we can stick stick with one instead.

0cd93ca4-716e-4076-b126-f3ff2ccf9581-0
00:54:13.680 --> 00:54:17.835
Anything related to functional we can
stick with dev 01, not integration part,

0cd93ca4-716e-4076-b126-f3ff2ccf9581-1
00:54:17.835 --> 00:54:21.096
something like that,
because all other environment having its

0cd93ca4-716e-4076-b126-f3ff2ccf9581-2
00:54:21.096 --> 00:54:24.200
own, its only burden is dev, right,
not other environment.

dc982acd-e495-495f-a91e-b6dae1fe11f0-0
00:54:24.560 --> 00:54:26.760
So yeah, yeah, yeah, OK.

37893195-85eb-4386-b2b4-ddae828bdce7-0
00:54:27.200 --> 00:54:31.680
So the lastly we've got sort of we've
gone over.

8556ba45-8676-484a-807a-2b92334006b5-0
00:54:32.960 --> 00:54:35.680
So again the similar code structure.

b26271eb-86e9-4900-99a5-71b4c991387c-0
00:54:35.680 --> 00:54:37.360
So the code is in.

94ac477f-807e-4638-9d7f-d187a8a76940-0
00:55:03.120 --> 00:55:10.641
So it's in arms project and so we looked
at the identities in the identity CIM

94ac477f-807e-4638-9d7f-d187a8a76940-1
00:55:10.641 --> 00:55:17.783
repo and there's Pradeep has created
another separate repo for integration

94ac477f-807e-4638-9d7f-d187a8a76940-2
00:55:17.783 --> 00:55:18.640
services.

e91378ad-fd4f-4705-bddc-b17d2dbb85f6-0
00:55:21.320 --> 00:55:25.320
So this file copy code already is merged
to domain.

c9c2d988-116d-4e98-a102-10fc79308965-0
00:55:26.760 --> 00:55:28.280
It should be.

5aec3262-0899-4193-bc9f-7d9fe07878c7-0
00:55:28.280 --> 00:55:32.040
I don't think there are any changes
remaining.

4e3c63b7-7457-4357-8cf9-1c11de1d1154-0
00:55:32.040 --> 00:55:34.200
The are there some part changes?

fdb1d22d-db82-4541-af6e-6d8135939c2c-0
00:55:36.360 --> 00:55:36.560
Yeah.

f8350d11-da42-4ba5-9220-03703b2b63ed-0
00:55:36.560 --> 00:55:38.520
So there are some logging improvements I
did.

4a674e1e-4a95-4d2b-a175-3c616c766124-0
00:55:38.520 --> 00:55:41.640
I'll match that before I go.

e49b1a1d-f2ba-4c27-93ac-05bbffe9139c-0
00:55:41.640 --> 00:55:41.760
Yep.

dcf753e0-ad8a-4ef1-b139-48ea264eee17-0
00:55:44.440 --> 00:55:52.819
But the the the source code is here in
the integration services report and the

dcf753e0-ad8a-4ef1-b139-48ea264eee17-1
00:55:52.819 --> 00:55:53.880
pipelines.

a4344edc-302d-48a4-8924-132d5702ed3c-0
00:55:54.040 --> 00:55:55.200
So same structure, right?

05df4ed7-a168-42e1-8e43-2133c2f3ded0-0
00:55:55.200 --> 00:55:56.640
Sources in source code.

7b76c13e-d28d-49a0-a894-5bb11cf8ad72-0
00:55:56.800 --> 00:56:05.063
Allthe.
net code is in here and there's a

7b76c13e-d28d-49a0-a894-5bb11cf8ad72-1
00:56:05.063 --> 00:56:13.720
pipeline same as the other ones,
the API 1.

c7981ecf-1ac9-48f8-8219-de66dedc90f8-0
00:56:13.720 --> 00:56:20.440
So this is the Devon.

ad6ff097-c730-4567-a223-475bb7067793-0
00:56:20.520 --> 00:56:22.600
Sorry no no,
this is the Devon environment.

6958ca63-75ba-48aa-8f24-b44f14b49731-0
00:56:24.000 --> 00:56:31.543
So when you have test,
you need to have something similar to

6958ca63-75ba-48aa-8f24-b44f14b49731-1
00:56:31.543 --> 00:56:37.480
this and it'll be like,
I think it can be here.

623df1f1-ed2b-4295-8f6a-5d1a568f4b33-0
00:56:38.600 --> 00:56:47.000
It should be like something like
something like this.

3877d37a-92bd-4bf9-9a8e-5f7c7e6dcc9c-0
00:56:54.980 --> 00:56:56.060
So you have another environment.

b2899209-7636-4f87-bf77-362f46481fbf-0
00:56:56.060 --> 00:57:04.560
So this would be environment test and
prefix is this is the Azure prefix.

3b3cdf8b-7980-4059-a290-1e36db512561-0
00:57:05.040 --> 00:57:12.960
It's DE and will depends on depth so that
they'll be like that.

19968bd3-f622-4132-9629-2bcef50972e9-0
00:57:12.960 --> 00:57:14.960
And then that's it.

4b0c0451-7b93-4b50-918e-65a9f11b7a36-0
00:57:14.960 --> 00:57:16.320
It'll get deployed.

8f97d358-394e-49e0-a931-c64241c565eb-0
00:57:16.440 --> 00:57:23.080
So you'll see the second test environment
in the in the in the pipeline.

efcb938d-f041-40ac-8876-aa3b05039a59-0
00:57:29.050 --> 00:57:32.210
That's pretty much it.

cedc9ce3-32f6-41b8-ab64-63bd045a13e8-0
00:57:32.770 --> 00:57:34.410
I think we'll go on in half an hour.

def520ac-5bcf-4e75-82e9-9cf45e621fc6-0
00:57:35.520 --> 00:57:36.040
That's OK.

c30c690b-60da-4933-a845-2beaeca4e567-0
00:57:36.040 --> 00:57:37.360
It's a good session, actually, Yeah.